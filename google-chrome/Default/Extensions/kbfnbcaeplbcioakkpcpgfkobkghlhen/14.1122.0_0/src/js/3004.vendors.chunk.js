/*! For license information please see 3004.vendors.chunk.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[3004],{61792:(e,t,n)=>{n.d(t,{a:()=>i});var i,r=n(5114),s=n(57050),o=n(8125);!function(e){let t,n,i;function a(e){return e.kind===t.active}function c(e){return e.kind===t.passive}function u(e){return e.kind===t.unknown}function l(e){return a(e)||u(e)}!function(e){e.unavailable="unavailable",e.active="active",e.passive="passive",e.disabled="disabled",e.pending="pending",e.unknown="unknown"}(t=e.Kind||(e.Kind={})),function(e){const t=(0,o.HP)((e=>{const t=Date.parse(e);return isNaN(t)?0:t}));function n(e){const t=e-Date.now();return Math.floor(t/36e5)}e.parseRefillDate=function(e){return t(e)},e.hoursUntilRefillDate=n,e.daysUntilRefillDate=function(e){return Math.floor(n(e)/24)}}(n=e.Active||(e.Active={})),function(t){t.empty={kind:e.Kind.passive,promptsAllocated:0,promptsRemaining:0,refillDate:0}}(i=e.Passive||(e.Passive={})),e.isActive=a,e.isPassive=c,e.isActiveOrPassive=(0,o.Kg)(a,c),e.isUnknown=u,e.isUsable=l,e.isVisible=function(e){return l(e)||c(e)},e.isDisabled=function(e){return e.kind===t.disabled},e.isUnavailable=function(e){return e.kind===t.pending||e.kind===t.unavailable||e.kind===t.disabled},e.fromUsage=function(n){return(0,s.zG)(r.fromNullable(n),r.fold((()=>({kind:e.Kind.unknown})),(n=>{const i=e.Active.parseRefillDate(n.refillDate);return n.promptsRemaining<0?{kind:t.unknown}:n.promptsRemaining>0?{kind:t.active,promptsRemaining:n.promptsRemaining,promptsAllocated:n.promptsAllocated,refillDate:i}:{kind:t.passive,promptsRemaining:n.promptsRemaining,promptsAllocated:n.promptsAllocated,refillDate:i}})))}}(i||(i={}))},37306:(e,t,n)=>{var i;n.d(t,{x:()=>i}),function(e){let t,n;!function(e){e.ok="ok",e.satisfied="satisfied",e.dissatisfied="dissatisfied"}(t=e.Mood||(e.Mood={})),function(e){e.resultCard="resultCard",e.quickReplyInitialActions="quickReplyInitialActions"}(n=e.Source||(e.Source={}))}(i||(i={}))},4283:(e,t,n)=>{n.d(t,{aU:()=>r,pY:()=>i,Cl:()=>P,ix:()=>I,ec:()=>U.e,a8:()=>R.a,MQ:()=>H.MQ,JZ:()=>T,_y:()=>s,nF:()=>U.n,x2:()=>_.x,TG:()=>C.T,lG:()=>E.l,H3:()=>m.H,s3:()=>g,JS:()=>G,x4:()=>p,z_:()=>f.z_,wR:()=>f.wR,SA:()=>H.SA,BC:()=>H.BC,Z7:()=>k,Zq:()=>A.Z,Bs:()=>j,wL:()=>H.wL,LA:()=>w.L,bm:()=>w.b,nI:()=>F,e7:()=>f.e7,LJ:()=>f.LJ,dr:()=>f.dr,jQ:()=>f.jQ,Gh:()=>f.Gh});var i,r,s,o=n(31699),a=n(73975),c=n(45701),u=n(57050),l=n(8125),d=n(5114),h=n(13004),f=n(9023);!function(e){let t,n;!function(e){e.create=function(e){return e}}(t=e.Id||(e.Id={})),function(e){e.create=function(e,t){return{id:e,kind:"string",value:t}}}(n=e.StringValue||(e.StringValue={}))}(i||(i={})),function(e){function t(e){return"followUpQuestion"===e.kind}function n(e){return"quickAction"===e.kind}function s(e){return"skillAction"===e.kind}let g,p,m,v,y,b,S,k,w;e.isFollowUpQuestionActionValue=t,e.isQuickActionValue=n,e.isSkillActionValue=s,e.isListableActionValue=(0,l.Kg)(t,n,s),e.isUserPromptActionValue=function(e){return"userPrompt"===e.kind},e.isQuickRewriteActionValue=function(e){return"quickRewrite"===e.kind},e.isFollowUpQuestionActionInput=function(e){return"followUpQuestion"===e.kind},e.isQuickActionInput=function(e){return"quickAction"===e.kind},e.isSkillActionInput=function(e){return"skillAction"===e.kind},e.createFollowUpQuestionActionInputOrQuickActionInput=function(e,t,n,s){var a;const c=Array.from(new Set(t.filter((0,u.ff)(v.Action.is)).map((e=>e.group)))).findIndex((t=>e.group===t)),l=v.Action.is(e)?p.knownStores.pinned:p.knownStores.ideas,g={id:r.Id.create(e.id),iconUrl:e.iconUrl,store:{id:l,label:v.Action.is(e)?"":f.wR.isQuickReply(n)?"Ways to reply":d.isSome(s)?`Your text: "${s.value}"`:"Ideas for you",view:v.Action.is(e)?r.Store.View.pinned:r.Store.View.normal,rank:null!==(a=p.ranks[l])&&void 0!==a?a:Number.MAX_SAFE_INTEGER},group:{id:m.Id.create(e.group),label:e.group,rank:c>-1?c:Number.MAX_SAFE_INTEGER},label:(0,o.sanitize)(e.label,{ALLOWED_TAGS:h.ap}),searchLabel:(0,o.sanitize)(e.label,{ALLOWED_TAGS:[]}),searchTags:e.searchTags,generatesTextType:d.fromNullable(e.generatesTextType)};if(1===e.args.length&&"string"===e.args[0].valueType){const t=e.args[0];return d.some(Object.assign(Object.assign({},g),{kind:"followUpQuestion",args:[{id:i.Id.create(t.name),kind:"string",label:t.label,hints:(0,u.zG)(d.fromNullable(t.hint),d.map((e=>({header:e.header,items:e.text}))))}],generatesTextType:d.fromNullable(e.generatesTextType)}))}return 0===e.args.length?d.some(Object.assign(Object.assign({},g),{kind:"quickAction",args:[]})):d.none},function(e){e.create=function(e){return e},e.eq=a.yv}(g=e.Id||(e.Id={})),function(e){let t,n;!function(e){e.eq=a.yv}(t=e.Id||(e.Id={})),function(e){e.normal="normal",e.pinned="pinned"}(n=e.View||(e.View={})),e.knownStores={ideas:"ideas",pinned:"pinned",appActions:"app-actions"},e.ranks={[e.knownStores.ideas]:0,[e.knownStores.pinned]:1,[e.knownStores.appActions]:2}}(p=e.Store||(e.Store={})),function(e){let t;!function(e){e.create=function(e){return e},e.eq=a.yv}(t=e.Id||(e.Id={}))}(m=e.Group||(e.Group={})),function(e){let t;!function(e){e.is=function(e){return"pinned"===e.group}}(t=e.Action||(e.Action={}))}(v||(v={})),function(e){e.fromInput=function(e,t){return Object.assign(Object.assign({},e),{args:[i.StringValue.create(e.args[0].id,t)]})}}(y=e.FollowUpQuestionActionValue||(e.FollowUpQuestionActionValue={})),function(e){e.fromSkill=function(e){var t;const n=p.knownStores.appActions;return{kind:"skillAction",id:g.create(e.id),store:{id:n,label:"App actions",view:r.Store.View.normal,rank:null!==(t=p.ranks[n])&&void 0!==t?t:Number.MAX_SAFE_INTEGER},group:{id:m.Id.create("app-actions"),label:"App actions",rank:Number.MAX_SAFE_INTEGER},iconUrl:e.iconUrl,label:(0,o.sanitize)(e.displayName,{ALLOWED_TAGS:h.ap}),searchLabel:(0,o.sanitize)(e.displayName,{ALLOWED_TAGS:[]}),searchTags:e.tags,generatesTextType:d.none,args:[],skill:e}}}(b=e.SkillActionInput||(e.SkillActionInput={})),function(e){e.ordByGroup=c.contramap((e=>e.group.rank))(c.ordNumber)}(S=e.ListableActionInput||(e.ListableActionInput={})),function(e){e.fromInput=function(e,t,n,r){return Object.assign(Object.assign({},e),{arg:i.StringValue.create(e.arg.id,t),useReferences:n,omitReferenceIds:r})}}(k=e.UserPromptActionValue||(e.UserPromptActionValue={})),function(e){e.fromInput=function(e){return Object.assign(Object.assign({},e),{args:[]})}}(w=e.QuickRewriteActionValue||(e.QuickRewriteActionValue={}))}(r||(r={})),function(e){let t;!function(e){e.create=function(e){return e}}(t=e.Id||(e.Id={})),e.isPending=function(e){return"pending"===e.kind},e.isReceived=function(e){return"received"===e.kind}}(s||(s={}));var g,p,m=n(62087),v=n(64015),y=n(17889),b=n(8709),S=n(95195);!function(e){let t;!function(e){e.create=e=>e}(t=e.Id||(e.Id={})),e.create=function(t){return Object.assign(Object.assign({},t),{id:e.Id.create(t.id),url:d.fromNullable(t.url),contextText:d.none})}}(g||(g={})),function(e){let t,n,i,r,s,o,c;function f(e){return"complete"===e.kind}function p(e){return"history"===e.kind}function m(e){return"inProgressOngoing"===e.kind}function k(e){return"inProgressPending"===e.kind}!function(e){e.create=function(e){return`${e}`},e.toPrimitive=function(e){return parseInt(e,10)},e.eq=a.yv}(t=e.Id||(e.Id={})),function(e){e.insert="insert",e.reportOffensive="reportOffensive"}(n=e.Feedback||(e.Feedback={})),function(e){e.insert="insert",e.copy="copy"}(i=e.PrimaryAction||(e.PrimaryAction={})),e.hasId=function(e){return"id"in e},e.isComplete=f,e.isHistory=p,e.isAIUsageNotification=function(e){return"aiUsageNotification"===e.kind},e.isStandardCompletedResult=(0,l.Kg)(f,p),e.isInProgressOngoing=m,e.isInProgressPending=k,e.isInProgressInterrupted=function(e){return"inProgressInterrupted"===e.kind},e.isInProgress=(0,l.Kg)(m,k),function(e){e.generic="generic",e.user="user"}(r=e.GeneratedTextVoice||(e.GeneratedTextVoice={})),function(t){t.createFromResultMessage=function(t){return(0,u.zG)(t.withVoiceText,(n=>{var i;const r=(0,u.zG)((0,h.DO)(null===(i=t.text)||void 0===i?void 0:i.delta),d.getOrElse((()=>new b.i)));return(0,u.zG)((0,h.DO)(null==n?void 0:n.delta),S.fromOption((()=>r)),S.map((n=>({generic:r,user:n,preferVoice:!0===(null==t?void 0:t.showVoiceTextByDefault)?e.GeneratedTextVoice.user:e.GeneratedTextVoice.generic}))))}))}}(s=e.ResultDelta||(e.ResultDelta={})),function(t){t.createFromCard=function(t){return{kind:"history",id:e.Id.create(t.id),header:"action"===t.title.kind?{label:t.title.label,iconUrl:""!==t.title.iconUrl.trim()?d.some(t.title.iconUrl):d.none,copiablePrompt:d.none}:{label:t.title.text,iconUrl:d.none,copiablePrompt:""!==t.title.text.trim()?d.some(t.title.text):d.none},replacementDelta:s.createFromResultMessage({text:t.text,withVoiceText:t.text.plain===t.withVoiceText.plain?void 0:t.withVoiceText,showVoiceTextByDefault:t.text.plain===t.withVoiceText.plain?void 0:t.showVoiceTextByDefault}),primaryAction:d.some(e.PrimaryAction.insert),references:(0,u.zG)(t.references,v.UI(g.create),y.c2)}}}(o=e.History||(e.History={})),function(e){e.fromInProgressResult=function(e,t){return Object.assign(Object.assign({},e),{kind:"aiUsageNotification",text:t})}}(c=e.AIUsageNotification||(e.AIUsageNotification={}))}(p||(p={}));var k,w=n(9295),_=n(37306),x=n(22232);!function(e){let t,n,i,r,s,o,a,c,l;!function(e){let t;!function(e){e.rephrase="rephrase",e.dismiss="dismiss",e.insert="insert",e.offensive="offensive",e.copy="copy",e.generationCompleted="generationCompleted"}(t=e.UserAction||(e.UserAction={}))}(t=e.Result||(e.Result={})),function(e){let t;!function(e){e.open="open",e.skip="skip",e.openFromBanner="openFromBanner",e.keepVoiceTag="keepTag",e.removeVoiceTag="removeTag"}(t=e.UserAction||(e.UserAction={}))}(n=e.VoiceProfile||(e.VoiceProfile={})),function(e){let t;!function(e){e.openStore="openStore",e.offensive="offensive"}(t=e.UserAction||(e.UserAction={}))}(i=e.Actions||(e.Actions={})),function(e){let t;!function(e){e.search="search"}(t=e.UserAction||(e.UserAction={}))}(r=e.Prompt||(e.Prompt={})),function(e){let t;!function(e){e.hover="hover",e.click="click"}(t=e.UserAction||(e.UserAction={}))}(s=e.UsageInfo||(e.UsageInfo={})),function(e){let t;!function(e){e.view="view"}(t=e.UserAction||(e.UserAction={}))}(o=e.HistoryButton||(e.HistoryButton={})),function(e){let t;!function(e){e.view="view",e.skip="skip",e.next="next"}(t=e.UserAction||(e.UserAction={}))}(a=e.Onboarding||(e.Onboarding={})),function(e){let t;!function(e){e.close="close",e.readyToInteract="readyToInteract"}(t=e.UserAction||(e.UserAction={}))}(c=e.Assistant||(e.Assistant={})),function(e){let t;!function(e){e.dontShowOnDocument="dontShowOnDocument",e.dontShowForever="dontShowForever"}(t=e.UserAction||(e.UserAction={}))}(l=e.AIUsageNotification||(e.AIUsageNotification={})),e.getComponentId=function(e,t,n){const r=(0,u.zG)(e.kind,(t=>{switch(t){case"result":return"card";case"voiceProfile":return"voice";case"actions":return e.userAction===i.UserAction.openStore?"group":"card";case"assistant":return"widget";case"onboardingPromptsTooltip":return"onboardingPromptTooltip";case"onboardingReviewTooltip":return"onboardingReviewtextTooltip";case"usageInfo":case"historyButton":case"prompt":case"onboardingPopup":case"BTSonboardingPopup":case"onboardingRewriteTooltip":case"onboardingKnowledgeHubTooltip":case"onboardingReferencesTooltip":case"onboardingHistoryTooltip":case"aiUsageNotification":return t;default:return(0,x.L0)(t)}}));return void 0!==n?`cheetah:history-card:${n}`:`cheetah:${r}${t?`:${t}`:""}`},e.getUserAction=function(e){return(0,u.zG)(e.kind,(t=>{switch(t){case"actions":return e.userAction===i.UserAction.openStore?"All Ideas":e.userAction;case"assistant":return e.userAction===c.UserAction.close?"dismiss":e.userAction;case"result":case"voiceProfile":case"prompt":case"usageInfo":case"historyButton":case"onboardingPopup":case"BTSonboardingPopup":case"onboardingPromptsTooltip":case"onboardingReviewTooltip":case"onboardingRewriteTooltip":case"onboardingKnowledgeHubTooltip":case"onboardingReferencesTooltip":case"onboardingHistoryTooltip":case"aiUsageNotification":return e.userAction;default:return(0,x.L0)(t)}}))}}(k||(k={}));var I,A=n(95010),C=n(47388),R=(n(41458),n(61792));!function(e){let t;!function(e){e.mount="mount",e.unmount="unmount",e.toolbarCloseButtonClick="toolbarCloseButtonClick",e.toolbarGoBackButtonClick="toolbarGoBackButtonClick",e.toolbarVoiceButtonClick="toolbarVoiceButtonClick",e.setVoiceButtonClick="setVoiceButtonClick",e.voiceProfileCloseButtonClick="voiceProfileCloseButtonClick",e.voiceProfileUseVoiceButtonClick="voiceProfileUseVoiceButtonClick",e.toneToggleClick="toneToggleClick",e.styleToggleClick="styleToggleClick",e.roleTypeaheadSelectionChange="roleTypeaheadSelectionChange",e.dialectDropdownSelectionChange="dialectDropdownSelectionChange",e.promptFieldTextChange="promptFieldTextChange",e.promptFieldFocusChange="promptFieldFocusChange",e.promptFieldAndMenuFocusChange="promptFieldAndMenuFocusChange",e.actionBrickClick="actionBrickClick",e.promptSubmitButtonClick="promptSubmitButtonClick",e.generateStopButtonClick="generateStopButtonClick",e.promptFieldKeyPressEscape="promptFieldKeyPressEscape",e.promptFieldKeyPressEnter="promptFieldKeyPressEnter",e.promptFieldKeyPressArrowDown="promptFieldKeyPressArrowDown",e.promptFieldKeyPressArrowUp="promptFieldKeyPressArrowUp",e.promptMenuKeyPressArrowDown="promptMenuKeyPressArrowDown",e.promptMenuKeyPressArrowUp="promptMenuKeyPressArrowUp",e.resultCardInsertButtonClick="resultCardInsertButtonClick",e.resultCardRephraseButtonClick="resultCardRephraseButtonClick",e.resultCardDismissButtonClick="resultCardDismissButtonClick",e.resultCardToggleGenericVoiceButtonClick="resultCardToggleGenericVoiceButtonClick",e.errorCardOkButtonClick="errorCardOkButtonClick",e.openFeedbackFormButtonClick="openFeedbackFormButtonClick",e.feedbackFormChange="feedbackFormChange",e.feedbackFormSubmitButtonClick="feedbackFormSubmitButtonClick",e.reportOffensiveResultButtonClick="reportOffensiveResultButtonClick",e.reportOffensiveActionsButtonClick="reportOffensiveActionsButtonClick",e.resultCardHeaderClick="resultCardHeaderClick",e.collapsePromptMenuButtonClick="collapsePromptMenuButtonClick",e.creditsInfoHover="creditsInfoHover",e.creditsInfoClick="creditsInfoClick",e.resultCardHoverChange="resultCardHoverChange",e.resultCardFocusChange="resultCardFocusChange",e.resultCardCopy="resultCardCopy",e.reportMenuVisibilityChange="reportMenuVisibilityChange",e.referencesVisibilityChange="referencesVisibilityChange",e.voiceProfileTabChange="voiceProfileTabChange",e.voiceTagClick="voiceTagClick",e.voiceTagPopoverCloseButtonClick="voiceTagPopoverCloseButtonClick",e.voiceTagPopoverKeepButtonClick="voiceTagPopoverKeepButtonClick",e.voiceTagPopoverRemoveButtonClick="voiceTagPopoverRemoveButtonClick",e.applyVoiceToWritingCheckboxChange="applyVoiceToWritingCheckboxChange",e.voiceDialectDropdownSelectionChange="voiceDialectDropdownSelectionChange",e.voiceRoleDropdownSelectionChange="voiceRoleDropdownSelectionChange",e.voiceSelectionsSaveButtonClick="voiceSelectionsSaveButtonClick",e.voiceSelectionsCancelButtonClick="voiceSelectionsCancelButtonClick",e.voiceSelectionsEditButtonClick="voiceSelectionsEditButtonClick",e.surveyRatingSelectionChange="surveyRatingSelectionChange",e.surveyOpenAnswerChange="surveyOpenAnswerChange",e.surveySubmitButtonClick="surveySubmitButtonClick",e.surveyKeyPressShiftEnter="surveyKeyPressShiftEnter",e.surveyCancelButtonClick="surveyCancelButtonClick",e.surveyCloseButtonClick="surveyCloseButtonClick",e.regenerateWithoutReferenceButtonClick="regenerateWithoutReferenceButtonClick",e.restoreHistoryButtonClick="restoreHistoryButtonClick",e.userPromptSubmit="userPromptSubmit"}(t=e.Kind||(e.Kind={})),e.is=function(e){return t=>t.kind===e},e.isResultAction=(0,l.Kg)(e.is(e.Kind.resultCardInsertButtonClick),e.is(e.Kind.resultCardRephraseButtonClick),e.is(e.Kind.resultCardDismissButtonClick),e.is(e.Kind.reportOffensiveResultButtonClick),e.is(e.Kind.regenerateWithoutReferenceButtonClick)),e.isSurveyAction=(0,l.Kg)(e.is(e.Kind.surveyOpenAnswerChange),e.is(e.Kind.surveySubmitButtonClick),e.is(e.Kind.surveyKeyPressShiftEnter),e.is(e.Kind.surveyCancelButtonClick),e.is(e.Kind.surveyCloseButtonClick),e.is(e.Kind.surveyRatingSelectionChange)),e.isSurveyImplicitDismissAction=(0,l.Kg)(e.is(e.Kind.promptSubmitButtonClick),e.is(e.Kind.actionBrickClick),e.is(e.Kind.resultCardInsertButtonClick),e.is(e.Kind.resultCardRephraseButtonClick),e.is(e.Kind.resultCardDismissButtonClick),e.is(e.Kind.resultCardHeaderClick))}(I||(I={})),(0,x.L0)(void 0);var T,P,O,E=n(8887),U=n(34795),B=n(17771),M=n(73129);!function(e){let t;function n(e){switch(e){case t.sensitiveResult:return{header:"Assistance is unavailable",text:"GrammarlyGO assistance is unavailable for that text or prompt.\nTry something else."};case t.overload:return{header:"Couldn’t generate text",text:"We’re handling a lot of prompts right now and couldn’t generate that text.\nPlease try again later."};case t.unsupportedLanguage:return{header:"Hmm, don’t know that language",text:"GrammarlyGO assistance is currently only available for English."};case t.critical:case t.timeout:case t.emptyResult:case t.truncatedResult:case t.usageExceeded:return{header:"Something went wrong",text:"We’re not sure what happened, but we couldn’t generate that text.\nPlease try again."};default:return(0,u.Rz)(e)}}!function(e){e.create=function(t){switch(t){case M.yb.oS.Generic:return e.critical;case M.yb.oS.Overflow:return e.truncatedResult;case M.yb.oS.PromptsLimitExceeded:return e.usageExceeded;case M.yb.oS.SensitiveContent:return e.sensitiveResult;case M.yb.oS.ServerOverloaded:return e.overload;case M.yb.oS.UnsupportedLanguage:return e.unsupportedLanguage;default:return(0,u.Rz)(t)}}}(t=e.Reason||(e.Reason={})),function(e){e.emptyResult="emptyResult",e.truncatedResult="truncatedResult",e.sensitiveResult="sensitiveResult",e.usageExceeded="usageExceeded",e.unsupportedLanguage="unsupportedLanguage",e.overload="overload",e.timeout="timeout",e.critical="critical"}(t=e.Reason||(e.Reason={})),e.create=function(e){const i=t.create(e.kind),r=(0,u.zG)(B.Y(d.Applicative)({header:(0,u.zG)(d.fromNullable(e.title),d.filter((e=>""!==e.trim()))),text:(0,u.zG)(d.fromNullable(e.text),d.filter((e=>""!==e.trim())))}),d.getOrElse((()=>n(i))));return Object.assign({reason:i},r)},e.createCriticalError=function(e){return{reason:t.critical,header:"Something went wrong",text:e?"We’re not sure what happened.\nPlease try again later.":"We’re not sure what happened, but we couldn’t generate that text.\nPlease try again."}},e.createEmptyResultError=function(){return Object.assign({reason:t.emptyResult},n(t.emptyResult))}}(T||(T={})),function(e){let t;!function(e){e.feedbackSubmitted="feedbackSubmitted",e.voiceTagRemoved="voiceTagRemoved"}(t=e.Kind||(e.Kind={}))}(P||(P={})),function(e){let t;e.create=function(e,n,i,r,s){return{id:t.create(e),iconUrl:n,displayName:i,srcUrl:r,tags:s}},function(e){e.create=function(e){return e}}(t=e.Id||(e.Id={}))}(O||(O={}));var j,z=n(80800);!function(e){let t;!function(e){let t;!function(e){e.Rating="rating",e.Feedback="feedback",e.Completed="completed",e.Closed="closed"}(t=e.Type||(e.Type={})),e.isOpen=e=>e!==t.Closed,e.toCAPIStage=e=>{switch(e){case t.Rating:return z.v0.Survey.Data.OpenAnswerScoreSurvey.scoreStage;case t.Feedback:case t.Closed:case t.Completed:return z.v0.Survey.Data.OpenAnswerScoreSurvey.submitStage;default:(0,x.L0)(e)}}}(t=e.Stage||(e.Stage={}))}(j||(j={}));var F,H=n(1021);!function(e){const t={"Cheetah/_System/Push/SimplifyRewrite":{copiablePrompt:d.none,iconUrl:d.some("https://assets.grammarly.com/cheetah/v1/actions/simplify.svg"),label:"Simplify your text"},"Cheetah/_System/Push/ImproveParagraph":{copiablePrompt:d.none,iconUrl:d.some("https://assets.grammarly.com/cheetah/v1/actions/improve.svg"),label:"Improve your text"}};e.toPreviousText=function(e){return(0,u.zG)(e,d.fromPredicate((e=>e.alertPname in t)),d.map((e=>({kind:"writerExpert",suggestionId:e.alertId,pname:e.alertPname,text:e.replacementText}))))},e.getInitialResult=function(e){const n=S.left((new b.i).insert(e.replacementText));return(0,u.zG)(d.fromNullable(t[e.alertPname]),d.map((t=>({kind:"complete",id:p.Id.create(0),header:t,replacementDelta:n,text:e.replacementText,references:d.none,source:d.none,changesSummary:d.none,timestamp:Date.now(),isRephraseable:!1,primaryAction:d.some(p.PrimaryAction.insert)}))))}}(F||(F={}));var N,G,V=n(69243),D=n(59502),L=n(73915);!function(e){e.Codec=V.readonly(V.type({action:V.readonly(V.string)}))}(N||(N={})),function(e){let t,n,i;!function(e){e.Codec=V.readonly(V.type({action:V.readonly(V.literal("error"))})),e.is=function(t){return e.Codec.is(t)}}(t=e.Error||(e.Error={})),function(e){e.Codec=V.readonly(V.type({action:V.readonly(V.literal("show_survey"))})),e.is=function(t){return e.Codec.is(t)}}(n=e.ShowSurvey||(e.ShowSurvey={})),function(e){let t,n;!function(e){e.Codec=V.readonly(V.type({action:V.readonly(V.literal("cheetah")),id:V.readonly(V.number)})),e.is=e.Codec.is}(t=e.CheetahAck||(e.CheetahAck={})),function(e){e.is=L.n(M.Pb.extend(D.Schemable)({any:D.id(),sensitiveString:D.string,sensitiveDelta:D.id()}))(M.Pb.ServerMessageImplementations).is}(n=e.CheetahProtocolServerMessage||(e.CheetahProtocolServerMessage={})),e.is=(0,l.Kg)(t.is,n.is)}(i=e.CheetahInboundCAPIMessage||(e.CheetahInboundCAPIMessage={})),e.is=(0,l.Kg)(t.is,n.is,i.is)}(G||(G={}));G.CheetahInboundCAPIMessage.is},1021:(e,t,n)=>{n.d(t,{MQ:()=>s,_H:()=>h,SA:()=>u,BC:()=>l,wL:()=>d});var i,r,s,o=n(57050),a=n(8125),c=n(22232);!function(e){e.info="info",e.warning="warning",e.error="error"}(i||(i={})),function(e){e.session="session",e.userSurvey="userSurvey",e.skill="skill",e.capi="capi"}(r||(r={})),function(e){let t;e.toJSON=function(e){var n;return(0,a.Kg)(t.UnsanitizeTextOnInboundCAPIMessageFailed.is,t.SanitizeTextOnOutboundCAPIMessageFailed.is)(e)?JSON.stringify({kind:e.kind,source:e.source,name:String(e.name),capiMessageAction:e.capiMessageAction,rawErrorName:e.rawError.name,rawErrorMessage:e.rawError.message,rawErrorStack:null!==(n=e.rawError.stack)&&void 0!==n?n:""}):(0,c.L0)(e)},function(e){let t,n,s;e.is=function(e){return e.kind===i.error},function(e){e.unsanitizeTextOnInboundCAPIMessageFailed="unsanitizeTextOnInboundCAPIMessageFailed",e.sanitizeTextOnOutboundCAPIMessageFailed="sanitizeTextOnOutboundCAPIMessageFailed"}(t=e.Name||(e.Name={})),function(e){e.create=function(e,n){return{kind:i.error,source:r.capi,name:t.unsanitizeTextOnInboundCAPIMessageFailed,capiMessageAction:e,rawError:n}},e.is=function(e){return e.name===t.unsanitizeTextOnInboundCAPIMessageFailed}}(n=e.UnsanitizeTextOnInboundCAPIMessageFailed||(e.UnsanitizeTextOnInboundCAPIMessageFailed={})),function(e){e.create=function(e,n){return{kind:i.error,source:r.capi,name:t.sanitizeTextOnOutboundCAPIMessageFailed,capiMessageAction:e,rawError:n}},e.is=function(e){return e.name===t.sanitizeTextOnOutboundCAPIMessageFailed}}(s=e.SanitizeTextOnOutboundCAPIMessageFailed||(e.SanitizeTextOnOutboundCAPIMessageFailed={}))}(t=e.Error||(e.Error={}))}(s||(s={}));var u,l,d,h,f=n(5114);!function(e){let t,n,s;e.toJSON=function(e){var i;const r={kind:e.kind,source:e.source,name:String(e.name),sessionMode:e.sessionMode};return(0,a.Kg)(t.GetContextSuccessful.is,t.GetHistorySuccessful.is,s.GetContextFailed.is,s.GetHistoryFailed.is,s.WaitForResultTimeout.is)(e)?JSON.stringify(r):(0,a.Kg)(t.ActionSuccessful.is,s.ActionFailed.is)(e)?JSON.stringify(Object.assign(Object.assign({},r),{actionId:e.actionId.toString()})):(0,a.Kg)(s.WaitForAckTimeout.is,s.WaitForContextTimeout.is,s.WaitForHistoryTimeout.is)(e)?JSON.stringify(Object.assign(Object.assign({},r),{sourceCommand:e.sourceCommand})):(0,a.Kg)(s.AssistantCloseFailed.is,s.SetVoiceProfileFailed.is,s.SubmitFeedbackFailed.is,s.ReportUphookShowFailed.is,s.ReportUphookClickFailed.is)(e)?JSON.stringify(Object.assign(Object.assign({},r),{rawErrorName:e.rawError.name,rawErrorMessage:e.rawError.message,rawErrorStack:null!==(i=e.rawError.stack)&&void 0!==i?i:""})):(0,a.Kg)(n.UnexpectedChunkReceived.is,n.UnexpectedResultReceived.is)(e)?JSON.stringify(Object.assign(Object.assign({},r),{expectedInProgressResultId:f.toNullable(e.expectedInProgressResultId),receivedInProgressResultId:e.receivedInProgressResultId})):(0,a.Kg)(n.CAPIErrorHandled.is,s.CAPIErrorUnhandled.is)(e)?JSON.stringify(Object.assign(Object.assign({},r),{errorCode:e.capiError.error,errorSeverity:String(e.capiError.severity)})):s.RegenerateResultFailed.is(e)?JSON.stringify(Object.assign(Object.assign({},r),{resultId:e.resultId,reason:e.reason})):(0,c.L0)(e)},function(e){let t,n,s,o;e.is=function(e){return e.kind===i.info},function(e){e.getContextSuccessful="getContextSuccessful",e.getHistorySuccessful="getHistorySuccessful",e.actionSuccessful="actionSuccessful"}(t=e.Name||(e.Name={})),function(e){e.create=function(e){return{source:r.session,kind:i.info,name:t.getContextSuccessful,sessionMode:e}},e.is=function(e){return e.name===t.getContextSuccessful}}(n=e.GetContextSuccessful||(e.GetContextSuccessful={})),function(e){e.create=function(e){return{source:r.session,kind:i.info,name:t.getHistorySuccessful,sessionMode:e}},e.is=function(e){return e.name===t.getHistorySuccessful}}(s=e.GetHistorySuccessful||(e.GetHistorySuccessful={})),function(e){e.create=function(e,n){return{source:r.session,kind:i.info,name:t.actionSuccessful,sessionMode:e,actionId:n}},e.is=function(e){return e.name===t.actionSuccessful}}(o=e.ActionSuccessful||(e.ActionSuccessful={}))}(t=e.Info||(e.Info={})),function(e){let t,n,s,o;e.is=function(e){return e.kind===i.warning},function(e){e.unexpectedChunkReceived="unexpectedChunkReceived",e.unexpectedResultReceived="unexpectedResultReceived",e.capiErrorHandled="capiErrorHandled"}(t=e.Name||(e.Name={})),function(e){e.is=function(e){return e.name===t.unexpectedChunkReceived},e.create=function(e,n,s){return{source:r.session,kind:i.warning,name:t.unexpectedChunkReceived,sessionMode:e,expectedInProgressResultId:n,receivedInProgressResultId:s}}}(n=e.UnexpectedChunkReceived||(e.UnexpectedChunkReceived={})),function(e){e.is=function(e){return e.name===t.unexpectedResultReceived},e.create=function(e,n,s){return{source:r.session,kind:i.warning,name:t.unexpectedResultReceived,sessionMode:e,expectedInProgressResultId:n,receivedInProgressResultId:s}}}(s=e.UnexpectedResultReceived||(e.UnexpectedResultReceived={})),function(e){e.create=function(e,n){return{source:r.session,kind:i.warning,name:t.capiErrorHandled,sessionMode:e,capiError:n}},e.is=function(e){return e.name===t.capiErrorHandled}}(o=e.CAPIErrorHandled||(e.CAPIErrorHandled={}))}(n=e.Warning||(e.Warning={})),function(e){let t,n,s,o,a,c,u,l,d,h,f,g,p,m,v,y;e.is=function(e){return e.kind===i.error},function(e){e.getContextFailed="getContextFailed",e.getHistoryFailed="getHistoryFailed",e.actionFailed="actionFailed",e.waitForContextTimeout="waitForContextTimeout",e.waitForHistoryTimeout="waitForHistoryTimeout",e.waitForResultTimeout="waitForResultTimeout",e.waitForAckTimeout="waitForAckTimeout",e.assistantCloseFailed="assistantCloseFailed",e.setVoiceProfileFailed="setVoiceProfileFailed",e.submitFeedbackFailed="submitFeedbackFailed",e.reportUphookShowFailed="reportUphookShowFailed",e.reportUphookClickFailed="reportUphookClickFailed",e.capiErrorUnhandled="capiErrorUnhandled",e.regenerateResultFailed="regenerateResultFailed"}(t=e.Name||(e.Name={})),function(e){e.getContext="getContext",e.getHistory="getHistory",e.action="action",e.searchReferences="searchReferences"}(n=e.SourceCommand||(e.SourceCommand={})),function(e){e.create=function(e){return{source:r.session,kind:i.error,name:t.getContextFailed,sessionMode:e}},e.is=function(e){return e.name===t.getContextFailed}}(s=e.GetContextFailed||(e.GetContextFailed={})),function(e){e.create=function(e){return{source:r.session,kind:i.error,name:t.getHistoryFailed,sessionMode:e}},e.is=function(e){return e.name===t.getHistoryFailed}}(o=e.GetHistoryFailed||(e.GetHistoryFailed={})),function(e){e.create=function(e,n){return{source:r.session,kind:i.error,name:t.actionFailed,sessionMode:e,actionId:n}},e.is=function(e){return e.name===t.actionFailed}}(a=e.ActionFailed||(e.ActionFailed={})),function(e){e.create=function(e,n){return{source:r.session,kind:i.error,name:t.waitForAckTimeout,sourceCommand:n,sessionMode:e}},e.is=function(e){return e.name===t.waitForAckTimeout}}(c=e.WaitForAckTimeout||(e.WaitForAckTimeout={})),function(e){e.create=function(e,n){return{source:r.session,kind:i.error,name:t.waitForContextTimeout,sourceCommand:n,sessionMode:e}},e.is=function(e){return e.name===t.waitForContextTimeout}}(u=e.WaitForContextTimeout||(e.WaitForContextTimeout={})),function(e){e.create=function(e){return{source:r.session,kind:i.error,name:t.waitForHistoryTimeout,sourceCommand:n.getHistory,sessionMode:e}},e.is=function(e){return e.name===t.waitForHistoryTimeout}}(l=e.WaitForHistoryTimeout||(e.WaitForHistoryTimeout={})),function(e){e.create=function(e){return{source:r.session,kind:i.error,name:t.waitForResultTimeout,sessionMode:e}},e.is=function(e){return e.name===t.waitForResultTimeout}}(d=e.WaitForResultTimeout||(e.WaitForResultTimeout={})),function(e){e.create=function(e,n){return{source:r.session,kind:i.error,name:t.assistantCloseFailed,sessionMode:e,rawError:n}},e.is=function(e){return e.name===t.assistantCloseFailed}}(h=e.AssistantCloseFailed||(e.AssistantCloseFailed={})),function(e){e.create=function(e,n){return{source:r.session,kind:i.error,name:t.setVoiceProfileFailed,sessionMode:e,rawError:n}},e.is=function(e){return e.name===t.setVoiceProfileFailed}}(f=e.SetVoiceProfileFailed||(e.SetVoiceProfileFailed={})),function(e){e.create=function(e,n){return{source:r.session,kind:i.error,name:t.submitFeedbackFailed,sessionMode:e,rawError:n}},e.is=function(e){return e.name===t.submitFeedbackFailed}}(g=e.SubmitFeedbackFailed||(e.SubmitFeedbackFailed={})),function(e){e.create=function(e,n){return{source:r.session,kind:i.error,name:t.reportUphookShowFailed,sessionMode:e,rawError:n}},e.is=function(e){return e.name===t.reportUphookShowFailed}}(p=e.ReportUphookShowFailed||(e.ReportUphookShowFailed={})),function(e){e.create=function(e,n){return{source:r.session,kind:i.error,name:t.reportUphookClickFailed,sessionMode:e,rawError:n}},e.is=function(e){return e.name===t.reportUphookClickFailed}}(m=e.ReportUphookClickFailed||(e.ReportUphookClickFailed={})),function(e){e.create=function(e,n){return{source:r.session,kind:i.error,name:t.capiErrorUnhandled,sessionMode:e,capiError:n}},e.is=function(e){return e.name===t.capiErrorUnhandled}}(v=e.CAPIErrorUnhandled||(e.CAPIErrorUnhandled={})),function(e){e.create=function(e,n,s){return{source:r.session,kind:i.error,name:t.regenerateResultFailed,sessionMode:e,resultId:n,reason:s}},e.is=function(e){return e.name===t.regenerateResultFailed}}(y=e.RegenerateResultFailed||(e.RegenerateResultFailed={}))}(s=e.Error||(e.Error={}))}(u||(u={})),function(e){let t,n;e.toJSON=function(e){var i,r;const s={kind:e.kind,source:e.source,name:String(e.name)};return n.GetSkillsFailed.is(e)?JSON.stringify(Object.assign(Object.assign({},s),{rawErrorName:e.rawError.name,rawErrorMessage:e.rawError.message,rawErrorStack:null!==(i=e.rawError.stack)&&void 0!==i?i:""})):t.GetSkillsSuccessful.is(e)?JSON.stringify(Object.assign(Object.assign({},s),{skills:JSON.stringify(e.skills)})):(0,a.Kg)(t.InitSkillSuccessful.is,t.TerminateSkillSuccessful.is)(e)?JSON.stringify(Object.assign(Object.assign({},s),{skill:JSON.stringify(e.skill)})):(0,a.Kg)(n.InitSkillFailed.is,n.TerminateSkillFailed.is)(e)?JSON.stringify(Object.assign(Object.assign({},s),{skill:JSON.stringify(f.toNullable(e.skill)),rawErrorName:e.rawError.name,rawErrorMessage:e.rawError.message,rawErrorStack:null!==(r=e.rawError.stack)&&void 0!==r?r:""})):(0,c.L0)(e)},function(e){let t,n,s,o;e.is=function(e){return e.kind===i.info},function(e){e.getSkillsSuccessful="getSkillsSuccessful",e.initSkillSuccessful="initSkillSuccessful",e.terminateSkillSuccessful="terminateSkillSuccessful"}(t=e.Name||(e.Name={})),function(e){e.create=function(e){return{kind:i.info,source:r.skill,name:t.getSkillsSuccessful,skills:e}},e.is=function(e){return e.name===t.getSkillsSuccessful}}(n=e.GetSkillsSuccessful||(e.GetSkillsSuccessful={})),function(e){e.create=function(e){return{kind:i.info,source:r.skill,name:t.initSkillSuccessful,skill:e}},e.is=function(e){return e.name===t.initSkillSuccessful}}(s=e.InitSkillSuccessful||(e.InitSkillSuccessful={})),function(e){e.create=function(e){return{kind:i.info,source:r.skill,name:t.terminateSkillSuccessful,skill:e}},e.is=function(e){return e.name===t.terminateSkillSuccessful}}(o=e.TerminateSkillSuccessful||(e.TerminateSkillSuccessful={}))}(t=e.Info||(e.Info={})),function(e){let t,n,s,o;e.is=function(e){return e.kind===i.error},function(e){e.getSkillsFailed="getSkillsFailed",e.initSkillFailed="initSkillFailed",e.terminateSkillFailed="terminateSkillFailed"}(t=e.Name||(e.Name={})),function(e){e.create=function(e){return{kind:i.error,source:r.skill,name:t.getSkillsFailed,rawError:e}},e.is=function(e){return e.name===t.getSkillsFailed}}(n=e.GetSkillsFailed||(e.GetSkillsFailed={})),function(e){e.create=function(e,n){return{kind:i.error,source:r.skill,name:t.initSkillFailed,skill:e,rawError:n}},e.is=function(e){return e.name===t.initSkillFailed}}(s=e.InitSkillFailed||(e.InitSkillFailed={})),function(e){e.create=function(e,n){return{kind:i.error,source:r.skill,name:t.terminateSkillFailed,skill:e,rawError:n}},e.is=function(e){return e.name===t.terminateSkillFailed}}(o=e.TerminateSkillFailed||(e.TerminateSkillFailed={}))}(n=e.Error||(e.Error={}))}(l||(l={})),function(e){let t,n,s;e.toJSON=function(e){var i,r;const o={kind:e.kind,source:e.source,name:String(e.name),surveyType:e.surveyType,surveyPlacement:e.surveyPlacement};return(0,a.Kg)(s.SubmitSurveyFailed.is,n.UnexpectedSurveyFormatReceived.is)(e)?JSON.stringify(o):t.SubmitSurveyInfo.is(e)?JSON.stringify(Object.assign(Object.assign({},o),{surveyStage:e.surveyStage,surveyDetailedPlacement:null!==(i=e.surveyDetailedPlacement)&&void 0!==i?i:null,surveyRating:e.surveyRating?e.surveyRating.toString():null,surveyOpenAnswer:null!==(r=e.surveyOpenAnswer)&&void 0!==r?r:null,surveyIsDismissed:e.surveyIsDismissed?String(e.surveyIsDismissed):null})):(0,c.L0)(e)},function(e){let t,n;e.is=function(e){return e.kind===i.info},function(e){e.submitSurvey="submitSurvey"}(t=e.Name||(e.Name={})),function(e){e.create=function(e,n,s,o,a,c,u){return{source:r.userSurvey,kind:i.info,name:t.submitSurvey,surveyPlacement:n,surveyStage:s,surveyType:e,surveyIsDismissed:o,surveyRating:a,surveyOpenAnswer:c,surveyDetailedPlacement:u}},e.is=function(e){return e.name===t.submitSurvey}}(n=e.SubmitSurveyInfo||(e.SubmitSurveyInfo={}))}(t=e.Info||(e.Info={})),function(e){let t,n;e.is=function(e){return e.kind===i.warning},function(e){e.unexpectedSurveyFormatReceived="unexpectedSurveyFormatReceived"}(t=e.Name||(e.Name={})),function(e){e.create=function(e,n,s){return{source:r.userSurvey,kind:i.warning,name:t.unexpectedSurveyFormatReceived,surveyPlacement:n,surveyType:e,surveyDetailedPlacement:s}},e.is=function(e){return e.name===t.unexpectedSurveyFormatReceived}}(n=e.UnexpectedSurveyFormatReceived||(e.UnexpectedSurveyFormatReceived={}))}(n=e.Warning||(e.Warning={})),function(e){let t,n;e.is=function(e){return e.kind===i.error},function(e){e.submitSurveyFailed="submitSurveyFailed"}(t=e.Name||(e.Name={})),function(e){e.create=function(e,n,s){return{source:r.userSurvey,kind:i.error,name:t.submitSurveyFailed,surveyPlacement:n,surveyType:e,surveyDetailedPlacement:s}},e.is=function(e){return e.name===t.submitSurveyFailed}}(n=e.SubmitSurveyFailed||(e.SubmitSurveyFailed={}))}(s=e.Error||(e.Error={}))}(d||(d={})),function(e){e.isInfo=e=>e.kind===i.info,e.isWarning=e=>e.kind===i.warning,e.isError=e=>e.kind===i.error,e.isSessionMonitoringEvent=e=>e.source===r.session,e.isUserSurveyMonitoringEvent=e=>e.source===r.userSurvey,e.isSkillMonitoringEvent=e=>e.source===r.skill,e.isCAPIMonitoringEvent=e=>e.source===r.capi,e.toJSON=function(t){return e.isSessionMonitoringEvent(t)?u.toJSON(t):e.isUserSurveyMonitoringEvent(t)?d.toJSON(t):e.isSkillMonitoringEvent(t)?l.toJSON(t):e.isCAPIMonitoringEvent(t)?s.toJSON(t):(0,o.Rz)(t)}}(h||(h={}))},47388:(e,t,n)=>{n.d(t,{T:()=>i});var i,r=n(22232);!function(e){let t;!function(e){e.initial="initial",e.initialBTS="initialBTS",e.history="history",e.prompts="prompts",e.review="review",e.rewrite="rewrite",e.knowledgeHub="knowledgeHub",e.references="references"}(t=e.StepName||(e.StepName={})),function(e){e.isAssistantOnboardingStep=function(t){switch(t){case e.prompts:case e.review:case e.knowledgeHub:case e.references:case e.history:return!0;case e.initial:case e.initialBTS:case e.rewrite:return!1;default:return(0,r.L0)(t)}},e.isTooltipOnboardingStep=function(t){switch(t){case e.prompts:case e.review:case e.rewrite:case e.knowledgeHub:case e.references:case e.history:return!0;case e.initial:case e.initialBTS:return!1;default:return(0,r.L0)(t)}}}(t=e.StepName||(e.StepName={}))}(i||(i={}))},8887:(e,t,n)=>{n.d(t,{l:()=>i});var i,r=n(22232);!function(e){let t;!function(e){e.close="close",e.tryItOut="tryItOut",e.mount="mount"}(t=e.Kind||(e.Kind={})),e.is=function(e){return t=>t.kind===e}}(i||(i={})),(0,r.L0)(void 0)},62087:(e,t,n)=>{n.d(t,{H:()=>i});var i,r=n(5114),s=n(64015),o=n(17889),a=n(57050);!function(e){let t,n;e.fromOuterContext=function(e){var n,i,c,u;const l=e=>(0,a.zG)(r.fromNullable(null==e?void 0:e.from),r.chain(s.YM),r.fold((()=>t.empty),t.fromNameAndEmailString)),d=e=>(0,a.zG)(r.fromNullable(null==e?void 0:e.to),r.chain(o.c2),r.map(o.UI(t.fromNameAndEmailString)),r.getOrElseW((()=>[]))),h=(0,a.zG)(r.fromNullable(e.items),r.chain(s.YM),r.getOrElseW((()=>{})));return{previousMessageInfo:{author:l(null==h?void 0:h.people),directRecipients:d(null==h?void 0:h.people),text:null!==(n=null==h?void 0:h.text)&&void 0!==n?n:""},title:null!==(i=e.title)&&void 0!==i?i:"",author:l(e.people),directRecipients:d(e.people),indirectRecipients:(0,a.zG)(r.fromNullable(null===(c=e.people)||void 0===c?void 0:c.cc),r.chain(o.c2),r.map(o.UI(t.fromNameAndEmailString)),r.getOrElseW((()=>[]))),undisclosedRecipients:(0,a.zG)(r.fromNullable(null===(u=e.people)||void 0===u?void 0:u.bcc),r.chain(o.c2),r.map(o.UI(t.fromNameAndEmailString)),r.getOrElseW((()=>[])))}},e.toOuterContext=function(t){return{title:t.title,people:{from:[e.Person.extractNameAndEmailString(t.author)],to:t.directRecipients.map(e.Person.extractNameAndEmailString),cc:t.indirectRecipients.map(e.Person.extractNameAndEmailString),bcc:t.undisclosedRecipients.map(e.Person.extractNameAndEmailString)},items:[{text:t.previousMessageInfo.text,people:{from:[e.Person.extractNameAndEmailString(t.previousMessageInfo.author)],to:t.previousMessageInfo.directRecipients.map(e.Person.extractNameAndEmailString)}}]}},e.empty={previousMessageInfo:{author:{name:"",email:""},directRecipients:[],text:""},title:"",author:{name:"",email:""},directRecipients:[],indirectRecipients:[],undisclosedRecipients:[]},function(e){e.empty={name:"",email:""},e.fromNameAndEmailString=function(t){return(0,a.zG)(r.fromNullable(t.match(/^([^<]*)<(.*)>$/)),r.map((e=>{var t,n,i,r;return{name:null!==(n=null===(t=e[1])||void 0===t?void 0:t.trim())&&void 0!==n?n:"",email:null!==(r=null===(i=e[2])||void 0===i?void 0:i.trim())&&void 0!==r?r:""}})),r.getOrElse((()=>e.empty)))},e.extractNameAndEmailString=function(e){const t=""!==e.email?`<${e.email}>`:"";return[e.name,t].filter((e=>""!==e)).join(" ")}}(t=e.Person||(e.Person={})),function(e){e.empty={author:{name:"",email:""},directRecipients:[],text:""}}(n=e.PreviousMessageInfo||(e.PreviousMessageInfo={}))}(i||(i={}))},9023:(e,t,n)=>{n.d(t,{z_:()=>i,wR:()=>s.w,e7:()=>o,LJ:()=>l,dr:()=>u,jQ:()=>c,Gh:()=>a});var i,r=n(5114),s=n(11610);function o(e){return s.w.isIdeation(e.mode)}function a(e){return s.w.isRewriteOrQuickRewrite(e.mode)}function c(e){return s.w.isQuickReply(e.mode)}function u(e){return s.w.isPushRewrite(e.mode)}function l(e){return s.w.isKnowledgeHub(e.mode)}!function(e){let t,n;!function(e){e.restoreDisabled="restoreDisabled",e.unknown="unknown",e.hasHistory="hasHistory",e.noHistory="noHistory",e.historyRequested="historyRequested",e.historyRestored="historyRestored"}(t=e.HistoryStatus||(e.HistoryStatus={})),e.toStarting=function(e){return"starting"===e.kind?r.some(e):r.none},e.toStarted=function(e){return"started"===e.kind?r.some(e):r.none},e.isStartedWithInProgressResult=function(e){return"started"===e.kind&&r.isSome(e.inProgressResult)},function(e){e.initial={kind:"starting",mode:s.w.ideation,selectedRange:r.none,selectedText:r.none,quickReplyContext:r.none,historyStatus:t.unknown,writingExpertContext:r.none,knowledgeHubContext:r.none,error:r.none}}(n=e.Starting||(e.Starting={}))}(i||(i={}))},34795:(e,t,n)=>{var i,r;n.d(t,{e:()=>i,n:()=>r}),function(e){e.initialActionsList="initialActionsList",e.followUpActionsList="followUpActionsList",e.creditsInfoButton="creditsInfoButton",e.promptInput="promptInput",e.promptMenuContent="promptMenuContent",e.skill="skill",e.referencesList="referencesList",e.historyButton="historyButton"}(i||(i={})),function(e){e.initialPopupAnchor="initialPopupAnchor",e.initialBTSPopupAnchor="initialBTSPopupAnchor",e.rewriteTooltipAnchor="rewriteTooltipAnchor"}(r||(r={}))},95010:(e,t,n)=>{n.d(t,{Z:()=>i});var i,r=n(95195),s=n(5114),o=n(64015),a=n(57050),c=n(69243),u=n(13004);!function(e){const t=(0,u.$d)()(["initial","initialBTS","prompts","review","rewrite","knowledgeHub","references","history"]),n=(0,u.$d)()(["extension","editor","llamaMac","llamaWin"]);function i(e,t){return`${e}|${t}`}function l(e,t,n){return`${e}|${t}|${n}`}function d(e){return s.isSome(b(e))}function h(e){return s.isSome(S(e))}const f=new c.Type("CompletedStepName",(e=>"string"==typeof e&&d(e)),((e,t)=>"string"==typeof e&&d(e)?c.success(e):c.failure(e,t)),c.identity),g=new c.Type("LastSeenStepName",(e=>"string"==typeof e&&h(e)),((e,t)=>"string"==typeof e&&h(e)?c.success(e):c.failure(e,t)),c.identity),p=c.readonly(c.partial({completed:c.readonlyArray(f),lastSeen:c.readonlyArray(g)}));let m,v,y;function b(e){return(0,a.zG)(s.some(e.split("|")),s.filter((e=>2===e.length)),s.filter((e=>t.includes(e[0])&&n.includes(e[1]))))}function S(e){return(0,a.zG)(s.some(e.split("|")),s.filter((e=>3===e.length)),s.filter((e=>t.includes(e[0])&&n.includes(e[1]))),s.filterMap((e=>(0,a.zG)(parseInt(e[2],10),(t=>Number.isNaN(t)?s.none:s.some([e[0],e[1],t]))))))}function k(e,t,n){var i,r,s,o;return{extension:{completed:t.some((t=>t[0]===e&&"extension"===t[1])),lastSeen:null===(i=n.find((t=>t[0]===e&&"extension"===t[1])))||void 0===i?void 0:i[2]},editor:{completed:t.some((t=>t[0]===e&&"editor"===t[1])),lastSeen:null===(r=n.find((t=>t[0]===e&&"editor"===t[1])))||void 0===r?void 0:r[2]},llamaMac:{completed:t.some((t=>t[0]===e&&"llamaMac"===t[1])),lastSeen:null===(s=n.find((t=>t[0]===e&&"llamaMac"===t[1])))||void 0===s?void 0:s[2]},llamaWin:{completed:t.some((t=>t[0]===e&&"llamaWin"===t[1])),lastSeen:null===(o=n.find((t=>t[0]===e&&"llamaWin"===t[1])))||void 0===o?void 0:o[2]}}}e.emptyClientStep={completed:!1,lastSeen:void 0},function(e){function t(e){return t=>e(t.extension)||e(t.editor)||e(t.llamaMac)||e(t.llamaWin)}e.anyClient=t,e.anyClientCompleted=t((e=>e.completed))}(m=e.Step||(e.Step={})),e.emptyStep={extension:e.emptyClientStep,llamaMac:e.emptyClientStep,llamaWin:e.emptyClientStep,editor:e.emptyClientStep},e.codec=new c.Type("UpstreamOnboarding",(e=>p.is(e)),((e,t)=>(0,a.zG)(p.validate(e,t),r.map((e=>{const t=(0,a.zG)(e.completed||[],o.UI(b),o.oA),n=(0,a.zG)(e.lastSeen||[],o.UI(S),o.oA);return{initial:k("initial",t,n),initialBTS:k("initialBTS",t,n),prompts:k("prompts",t,n),review:k("review",t,n),rewrite:k("rewrite",t,n),knowledgeHub:k("knowledgeHub",t,n),references:k("references",t,n),history:k("history",t,n)}})))),(e=>({completed:(0,a.zG)(Object.entries(e),o.tS((([e,t])=>function(e,t){return(0,a.zG)(Object.entries(t),o.tS((([t,n])=>n.completed?[i(e,t)]:[])))}(e,t)))),lastSeen:(0,a.zG)(Object.entries(e),o.tS((([e,t])=>function(e,t){return(0,a.zG)(Object.entries(t),o.tS((([t,n])=>n.lastSeen?[l(e,t,n.lastSeen)]:[])))}(e,t))))}))),e.decode=function(t){return(0,a.zG)(decodeURIComponent(t),(n=>{try{const t=JSON.parse(n);return e.codec.decode(t)}catch(e){return r.left(`Cannot decode raw onboarding state: ${t}.`)}}),r.getOrElse((()=>e.State.empty)))},e.encode=function(t){return encodeURIComponent(JSON.stringify(e.codec.encode(t)))},function(t){t.empty={initial:e.emptyStep,initialBTS:e.emptyStep,prompts:e.emptyStep,review:e.emptyStep,rewrite:e.emptyStep,knowledgeHub:e.emptyStep,references:e.emptyStep,history:e.emptyStep},t.toClientState=function(e,t){return{initial:e.initial[t],initialBTS:e.initialBTS[t],prompts:e.prompts[t],review:e.review[t],rewrite:e.rewrite[t],knowledgeHub:e.knowledgeHub[t],references:e.references[t],history:e.history[t]}},t.patch=function(e,t){return n=>({initial:Object.assign(Object.assign({},n.initial),{[t]:e.initial}),initialBTS:Object.assign(Object.assign({},n.initialBTS),{[t]:e.initialBTS}),prompts:Object.assign(Object.assign({},n.prompts),{[t]:e.prompts}),review:Object.assign(Object.assign({},n.review),{[t]:e.review}),rewrite:Object.assign(Object.assign({},n.rewrite),{[t]:e.rewrite}),knowledgeHub:Object.assign(Object.assign({},n.knowledgeHub),{[t]:e.knowledgeHub}),references:Object.assign(Object.assign({},n.references),{[t]:e.references}),history:Object.assign(Object.assign({},n.history),{[t]:e.history})})}}(v=e.State||(e.State={})),function(t){t.empty={initial:e.emptyClientStep,initialBTS:e.emptyClientStep,prompts:e.emptyClientStep,review:e.emptyClientStep,rewrite:e.emptyClientStep,knowledgeHub:e.emptyClientStep,references:e.emptyClientStep,history:e.emptyClientStep}}(y=e.ClientState||(e.ClientState={}))}(i||(i={}))},41458:(e,t,n)=>{var i;n.d(t,{n:()=>i}),function(e){let t;!function(e){e.create=function(e){return e}}(t=e.Id||(e.Id={}))}(i||(i={}))},9295:(e,t,n)=>{n.d(t,{L:()=>i,b:()=>r});var i,r,s=n(73975),o=n(5114),a=n(64015),c=n(48044),u=n(13853),l=n(22232);!function(e){let t,n,i,r,d,h;!function(e){let t;!function(e){e.create=function(e){return e},e.eq=s.yv}(t=e.Id||(e.Id={}))}(t=e.Tone||(e.Tone={})),function(e){let t;!function(e){e.create=function(e){return e},e.eq=s.yv}(t=e.Id||(e.Id={}))}(n=e.Style||(e.Style={})),function(e){let t;!function(e){e.create=function(e){return e},e.eq=s.yv}(t=e.Id||(e.Id={}))}(i=e.Role||(e.Role={})),function(e){let t,n;function i(e){switch(e){case t.american:return"American English";case t.australian:return"Australian English";case t.british:return"British English";case t.canadian:return"Canadian English";case t.indian:return"Indian English";default:return(0,l.L0)(e)}}function r(e){switch(e){case t.american:return"https://assets.grammarly.com/emoji/v1/1f1fa-1f1f8.svg";case t.australian:return"https://assets.grammarly.com/emoji/v1/1f1e6-1f1fa.svg";case t.british:return"https://assets.grammarly.com/emoji/v1/1f1ec-1f1e7.svg";case t.canadian:return"https://assets.grammarly.com/emoji/v1/1f1e8-1f1e6.svg";case t.indian:return"https://assets.grammarly.com/emoji/v1/1f1ee-1f1f3.svg";default:return(0,l.L0)(e)}}!function(e){e.fromString=function(t){switch(t){case"american":return e.american;case"australian":return e.australian;case"british":return e.british;case"canadian":return e.canadian;case"indian":return e.indian;default:return(0,l.L0)(t)}}}(t=e.Value||(e.Value={})),function(e){e.american="american",e.australian="australian",e.british="british",e.canadian="canadian",e.indian="indian"}(t=e.Value||(e.Value={})),function(e){e.create=function(e){return e},e.eq=s.yv}(n=e.Id||(e.Id={})),e.american={id:n.create(t.american),label:i(t.american),iconUrl:r(t.american)},e.australian={id:n.create(t.australian),label:i(t.australian),iconUrl:r(t.australian)},e.british={id:n.create(t.british),label:i(t.british),iconUrl:r(t.british)},e.canadian={id:n.create(t.canadian),label:i(t.canadian),iconUrl:r(t.canadian)},e.indian={id:n.create(t.indian),label:i(t.indian),iconUrl:r(t.indian)},e.all=function(){return[e.american,e.australian,e.british,e.canadian,e.indian]}}(r=e.Dialect||(e.Dialect={})),function(e){e.eq=s.MW({selectedStyle:n.Id.eq,selectedTonesPerStyle:c.Eh(n.Id.eq,u.Eh(t.Id.eq)),selectedRole:o.getEq(i.Id.eq),selectedDialect:r.Id.eq})}(d=e.Selections||(e.Selections={})),e.toLegacyVoiceProfile=function(e){return"legacyVoiceProfile"===e.kind?o.some(e):o.none},function(e){const t=s.MW({name:s.yv,state:s.yv}),n=s.MW({name:s.yv,tags:a.Eh(t)}),c=s.MW({name:s.yv,summary:s.yv,selected:s.vD,sections:a.Eh(n)}),u=a.Eh(c);e.eqByRoleDialectProfileAndIsEnabledByDefault=s.MW({profiles:u,selectedRole:o.getEq(i.Id.eq),selectedDialect:r.Id.eq,isEnabledByDefault:s.vD})}(h=e.NewSelections||(e.NewSelections={})),e.toNewVoiceProfile=function(e){return"newVoiceProfile"===e.kind?o.some(e):o.none}}(i||(i={})),function(e){e.createId=({tagName:e,sectionName:t,profileName:n})=>`${t}-${e}-${n}`}(r||(r={}))},73129:(e,t,n)=>{n.d(t,{Pb:()=>r.Pb,g8:()=>i.g,yb:()=>r.yb});var i=n(95611),r=n(58348)},58348:(e,t,n)=>{n.d(t,{Pb:()=>o,yb:()=>s});var i=n(71761),r=n(9090),s=n(50687);const o=i;r.i},31570:(e,t,n)=>{n.d(t,{$:()=>g});var i=n(5114),r=n(57050),s=n(9922),o=n(60797),a=n(77176),c=n(98403),u=n(16118),l=n(38983),d=n(4283),h=n(73129),f=n(75055);class g{constructor(e,t=new f.W(g.name)){this._capiService=e,this._logger=t,this._subs=new s.w.Keeper,this.availability=l.h.create({kind:d.a8.Kind.pending}),this.promptsAllocated=this.availability.view((e=>(0,r.zG)(e,i.fromPredicate(d.a8.isActiveOrPassive),i.map((e=>e.promptsAllocated))))),this.settings=l.h.create({inlineQuickReplyEnabled:!1,inlineRewriteEnabled:!1}),this._subs.push(this._capiService.startAckMessageCheetahStateInfo.pipe(o.oA).subscribe((({allowedFeatures:e,cheetahState:t})=>{this.availability.set(e.includes(h.g8)?d.a8.fromUsage(null==t?void 0:t.usage):{kind:d.a8.Kind.unavailable}),this.settings.set(e.includes(h.g8)&&(null==t?void 0:t.settings)?t.settings:{inlineQuickReplyEnabled:!1,inlineRewriteEnabled:!1})})),(0,r.zG)(this._capiService.relevantInboundCAPIMessages,a.U((e=>{switch(e.action){case"cheetah:setContext":case"cheetah:result":return i.some(e.usage);case"cheetah:setUserState":return i.some(e.state.usage);default:return i.none}})),o.oA,a.U(d.a8.fromUsage)).subscribe(c.wW(this.availability)),(0,r.zG)(this._capiService.relevantInboundCAPIMessages,a.U((e=>"cheetah:setUserState"===e.action?i.some(e.state.settings):i.none)),o.oA).subscribe(c.wW(this.settings)),this.availability.pipe(u.G()).subscribe((([e,t])=>{this._logger.debug("availability updated",{prevAvailability:e,newAvailability:t}),d.a8.isActiveOrPassive(t)&&0===t.refillDate&&this._logger.warn("availability updated - error parsing refill date for new availability, setting timestamp to 0",{prevAvailability:e,newAvailability:t})})))}dispose(){this._subs.dispose()}}},13287:(e,t,n)=>{n.d(t,{t:()=>g});var i=n(57050),r=n(14601),s=n(32952),o=n(85985),a=n(71032),c=n(12126),u=n(5114),l=n(62965),d=n(4283),h=n(13004),f=n(97834);class g{constructor(e,t,n,i=u.none,o=f.g.getInstance()){this._genericInboundCAPIMessages=e,this._sendCAPIMessage=t,this._startAckMessageCheetahStateInfo=n,this._dlpOptions=i,this._monitoringService=o,this._sub=new r.w,this._relevantInboundCAPIMessages=new s.xQ,this.relevantInboundCAPIMessages=this._relevantInboundCAPIMessages.asObservable(),this.startAckMessageCheetahStateInfo=this._startAckMessageCheetahStateInfo.view(),this._sub.add(this._getRelevantInboundCAPIMessagesObs().subscribe(this._relevantInboundCAPIMessages))}cheetahGetContext(e){const t=(0,i.zG)(this._dlpOptions,u.map((({sanitizeText:t})=>(0,h.Av)(e.outerContext,t))),u.getOrElse((()=>Promise.resolve(e.outerContext))));return(0,i.zG)(l.Y3((()=>t),(e=>new Error(JSON.stringify(e)))),l.Vn((e=>(this._monitoringService.notify(d.MQ.Error.SanitizeTextOnOutboundCAPIMessageFailed.create("cheetah:getContext",e)),e))),l.tS((t=>this._sendCAPIMessage({action:"cheetah:getContext",data:Object.assign(Object.assign({},e),{outerContext:t}),shouldInjectRev:!0,shouldInjectSessionId:!1}))))}cheetahAction(e){const t=(0,i.zG)(this._dlpOptions,u.map((({sanitizeText:t})=>(0,h.Ly)(e.args,t))),u.getOrElse((()=>Promise.resolve(e.args)))),n=(0,i.zG)(this._dlpOptions,u.map((({sanitizeText:t})=>(0,h.HL)(e.previousText,t))),u.getOrElse((()=>Promise.resolve(e.previousText))));return(0,i.zG)(l.Y3((()=>t),(e=>new Error(JSON.stringify(e)))),l.tS((e=>l.Y3((()=>n.then((t=>({sanitizedArgs:e,sanitizedPreviousText:t})))),(e=>new Error(JSON.stringify(e)))))),l.Vn((e=>(this._monitoringService.notify(d.MQ.Error.SanitizeTextOnOutboundCAPIMessageFailed.create("cheetah:action",e)),e))),l.tS((({sanitizedArgs:t,sanitizedPreviousText:n})=>this._sendCAPIMessage({action:"cheetah:action",data:Object.assign(Object.assign({},e),{args:t,previousText:n}),shouldInjectRev:!0,shouldInjectSessionId:!1}))))}cheetahGetHistory(){return this._sendCAPIMessage({action:"cheetah:getHistory",shouldInjectRev:!1,data:{},shouldInjectSessionId:!1})}cheetahGetUserState(){return this._sendCAPIMessage({action:"cheetah:getUserState",data:{},shouldInjectRev:!1,shouldInjectSessionId:!1})}cheetahInterrupt(e){return this._sendCAPIMessage({action:"cheetah:interrupt",data:e,shouldInjectRev:!1,shouldInjectSessionId:!1})}cheetahSearchReferences(e){return this._sendCAPIMessage({action:"cheetah:searchReferences",data:e,shouldInjectRev:!1,shouldInjectSessionId:!1})}cheetahSetVoice(e){return this._sendCAPIMessage({action:"cheetah:setVoice",data:e,shouldInjectRev:!1,shouldInjectSessionId:!1})}cheetahSetVoiceProfile(e){return this._sendCAPIMessage({action:"cheetah:setVoiceProfile",data:e,shouldInjectRev:!1,shouldInjectSessionId:!1})}user_action(e){return this._sendCAPIMessage({action:"user_action",data:e,shouldInjectRev:!1,shouldInjectSessionId:!0})}set_context(e){return this._sendCAPIMessage({action:"set_context",data:e,shouldInjectRev:!0,shouldInjectSessionId:!1})}submit_survey_result(e){return this._sendCAPIMessage({action:"submit_survey_result",data:e,shouldInjectRev:!0,shouldInjectSessionId:!1})}dispose(){this._sub.unsubscribe()}_getRelevantInboundCAPIMessagesObs(){const e=this._genericInboundCAPIMessages.pipe(o.h(d.JS.is));return(0,i.zG)(this._dlpOptions,u.fold((()=>e),(({unsanitizeText:t})=>e.pipe(a.b((e=>c.D((0,i.zG)(e,(e=>"cheetah:setContext"===e.action&&e.context.intent?(0,h.Tc)(e,t):"cheetah:chunk"===e.action?(0,h.bB)(e,t):"cheetah:result"===e.action?(0,h.li)(e,t):Promise.resolve(e)),(t=>t.catch((t=>(this._monitoringService.notify(d.MQ.Error.UnsanitizeTextOnInboundCAPIMessageFailed.create(e.action,new Error(`${t}`))),e))))))))))))}}},50685:(e,t,n)=>{n.d(t,{WQ:()=>r.W,gz:()=>i.g,jI:()=>r.j});n(85612),n(31570),n(9137);var i=n(97834),r=(n(13287),n(75055));n(36582)},75055:(e,t,n)=>{var i;n.d(t,{W:()=>r,j:()=>i}),function(e){e.isErrorLike=function(e){const t=e;return null!=t&&(void 0!==t.message&&void 0!==t.name||void 0!==t.stack)}}(i||(i={}));class r{constructor(e){this.namespace=e}static configureAllLoggers(e){r._isEnabled="prod"!==e.env}trace(e,t,n){this._printToConsole("trace",e,t,n)}warn(e,t,n){this._printToConsole("warn",e,t,n)}debug(e,t,n){this._printToConsole("debug",e,t,n)}info(e,t,n){this._printToConsole("info",e,t,n)}error(e,t,n){this._printToConsole("error",e,t,n)}fatal(e,t,n){this._printToConsole("fatal",e,t,n)}_getMsgWithNamespace(e){return`[${r._rootNamespace}.${this.namespace}]: ${e}`}_printToConsole(e,t,n,i){if("fatal"===e)return void console.error(t,n,i);if(!r._isEnabled)return;const s=this._getMsgWithNamespace(t);n&&i?console[e](s,n,i):!n&&i?console[e](s,i):n&&!i?console[e](s,n):console[e](s)}}r._rootNamespace="CheetahWeb",r._isEnabled=!1},97834:(e,t,n)=>{n.d(t,{g:()=>r});var i=n(32952);class r{constructor(){this._events=new i.xQ}static getInstance(){return null===r.instance&&(r.instance=new r),r.instance}notify(e){this._events.next(e)}get events(){return this._events.asObservable()}}r.instance=null},85612:(e,t,n)=>{n.d(t,{Z:()=>W});var i=n(17771),r=n(64015),s=n(17889),o=n(62965),a=n(57050),c=n(28043),u=n(50628),l=n(84966),d=n(9922),h=n(98403),f=n(80900),g=n(5114),p=n(83078),m=n(22232),v=n(8125),y=n(38983),b=n(4283),S=n(73129),k=n(13004),w=n(75055),_=n(97834),x=n(30816),I=n(31699),A=n(95195),C=n(32426);function R(e,t){switch(e.historyStatus){case b.z_.HistoryStatus.restoreDisabled:return e.historyStatus;case b.z_.HistoryStatus.unknown:case b.z_.HistoryStatus.noHistory:case b.z_.HistoryStatus.hasHistory:return void 0!==t?t>0?b.z_.HistoryStatus.hasHistory:b.z_.HistoryStatus.noHistory:b.z_.HistoryStatus.unknown;case b.z_.HistoryStatus.historyRequested:case b.z_.HistoryStatus.historyRestored:return"started"===e.kind&&void 0!==e.results.find(b.x4.isHistory)?b.z_.HistoryStatus.historyRestored:b.z_.HistoryStatus.restoreDisabled;default:(0,m.L0)(e.historyStatus)}}function T(e,t=!1){return(0,a.zG)(e.replacementDelta,A.fold(a.yR,(({preferVoice:e,generic:n,user:i})=>t?e===b.x4.GeneratedTextVoice.generic?n:i:n)),(e=>(0,k.l)(e,"")))}function P(e,t){return o.Vn((n=>(e.error(t(n)),n)))}function O(e){return o.fj((()=>"started"===e.kind?A.right(e):A.left(new Error("Session not started"))))}function E(e,t,n,i){var s;const o=(0,a.zG)(b.z_.toStarted(n),g.fold((()=>[]),(e=>e.voiceProfile.roles)));return{kind:"newVoiceProfile",userName:e.userName,title:e.title,subTitle:e.subTitle,profiles:e.profiles,isEnabledByDefault:e.myVoiceIsEnabledByDefault.state,isEnabledByDefaultLabel:e.myVoiceIsEnabledByDefault.label,dialects:b.LA.Dialect.all(),roles:(0,a.zG)(null!==(s=t.roles)&&void 0!==s?s:[],r.UI((e=>({id:b.LA.Role.Id.create(e),label:e}))),(e=>e.length>0?e:o)),selectedDialect:(0,a.zG)(b.z_.toStarted(n),g.fold((()=>b.LA.Dialect.Id.create(i)),(e=>e.voiceProfile.selectedDialect))),selectedRole:(0,a.zG)(g.fromNullable(t.selectedRole),g.map((e=>e.trim())),g.filter((e=>""!==e)),g.map(b.LA.Role.Id.create)),needsSetup:!1}}function U(e,t,n){var i,s;const o=(0,a.zG)(b.z_.toStarted(t),g.map((e=>e.voiceProfile)),g.chain(b.LA.toLegacyVoiceProfile),g.fold((()=>[]),(e=>e.styles))),c=(0,a.zG)(b.z_.toStarted(t),g.fold((()=>[]),(e=>e.voiceProfile.roles))),u=(0,a.zG)(null!==(i=e.styles)&&void 0!==i?i:[],r.UI((e=>({id:b.LA.Style.Id.create(e.button.label),label:e.button.label,iconUrl:e.button.iconUrl,tones:e.tones.map((e=>({id:b.LA.Tone.Id.create(e.label),label:e.label,iconUrl:e.iconUrl,description:e.description}))),maxTones:e.maxTones,description:e.button.description}))),(e=>e.length>0?e:o)),l=b.LA.Style.Id.create(e.selectedStyle),d=u.find((e=>b.LA.Style.Id.eq.equals(e.id,l)));return{kind:"legacyVoiceProfile",styles:u,roles:(0,a.zG)(null!==(s=e.roles)&&void 0!==s?s:[],r.UI((e=>({id:b.LA.Role.Id.create(e),label:e}))),(e=>e.length>0?e:c)),selectedStyle:l,selectedTonesPerStyle:(new Map).set(l,new Set(e.selectedTones.filter((e=>null==d?void 0:d.tones.map((e=>e.id.toString())).includes(e))))),selectedRole:(0,a.zG)(g.fromNullable(e.selectedRole),g.map((e=>e.trim())),g.filter((e=>""!==e)),g.map(b.LA.Role.Id.create)),dialects:b.LA.Dialect.all(),selectedDialect:(0,a.zG)(b.z_.toStarted(t),g.fold((()=>b.LA.Dialect.Id.create(n)),(e=>e.voiceProfile.selectedDialect))),needsSetup:e.needSetup}}function B(e,t,n,i){return[...(0,a.zG)(e,r.UI((t=>b.aU.createFollowUpQuestionActionInputOrQuickActionInput(t,e,n,i))),r.oA),...t.map(b.aU.SkillActionInput.fromSkill)]}function M(e,t){const n=(0,a.zG)(e.args,r.YM,g.map((t=>({id:b.aU.Id.create(e.id),kind:"userPrompt",arg:{id:b.pY.Id.create(t.name),kind:"string",label:t.label,hints:(0,a.zG)(g.fromNullable(t.hint),g.map((e=>({header:e.header,items:e.text}))))},generatesTextType:g.some(S.yb.cX.Insertable),useReferences:g.none,omitReferenceIds:g.none}))));return g.isNone(n)&&t.warn("_extractUserPromptAction() - failed to extract user prompt action, received empty action args",{promptAction:e}),n}function j(e){return{kind:"quickRewrite",id:b.aU.Id.create(e.id),label:(0,I.sanitize)(e.label,{ALLOWED_TAGS:k.ap}),iconUrl:e.iconUrl,generatesTextType:g.fromNullable(e.generatesTextType)}}function z(e){return(0,a.zG)(g.fromNullable(e),g.map((e=>(0,I.sanitize)(e,{ALLOWED_TAGS:[...k.ap,"person"]}))),g.map((e=>e.trim())),g.filter((e=>e.length>0)))}function F(e){return{kind:b.x4.isComplete(e)?"regular":b.x4.isHistory(e)?"history":(0,m.L0)(e),text:T(e)}}const H=g.fromNullable;function N(e){switch(e){case b.wR.ideation:return S.yb.s2.Ideation;case b.wR.rewrite:return S.yb.s2.Rewrite;case b.wR.quickRewrite:return S.yb.s2.QuickRewrite;case b.wR.quickReply:return S.yb.s2.QuickReply;case b.wR.pushRewrite:return S.yb.s2.PushRewrite;case b.wR.knowledgeHub:return S.yb.s2.Ideation;default:return(0,a.Rz)(e)}}function G(e){return(0,a.zG)(e.quickReplyContext,g.map(b.H3.toOuterContext))}function V(e){var t;return(0,a.zG)(null!==(t=function(e){var t;return null===(t=e.match(/^https:\/\/docs.google.com\/[a-zA-Z0-9-_]+\/d\/([a-zA-Z0-9-_]+)/))||void 0===t?void 0:t[1]}(e))&&void 0!==t?t:function(e){var t;const n=null!==(t=e.match(/^https:\/\/([a-zA-Z0-9-_]+).atlassian.net\/wiki\/spaces\/[a-zA-Z0-9-_]+\/pages\/([0-9]+)/))&&void 0!==t?t:[];return n[1]&&n[2]?`${n[1]}:${n[2]}`:void 0}(e),g.fromNullable,g.map(D))}function D(e){const t=(new TextEncoder).encode(e);return x.Buffer.from((0,k.Bk)(t)).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}var L=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};class W{constructor(e){var t,n,i,r,s,o;if(this._params=e,this._subs=new d.w.Keeper,this._session=y.h.create(b.z_.Starting.initial),this._resultById=new Map,this._contextIdByResultId=new Map,this._contextById=new Map,this._historyResultIdByGetContextMessageId=new Map,this._stateBlobByContextId=new Map,this._initialReceivedContext=null,this._upstreamDialect=y.h.create(b.LA.Dialect.Id.create(b.LA.Dialect.Value.american)),this._cheetahAckIds=new Set,this._searchReferencesUrlsById=new Map,this._cheetahAckHandlers=new Array,this._resultTimeout=void 0,this._contextTimeout=void 0,this._historyTimeout=void 0,this._cheetahAckTimeout=void 0,this._historyAckHandler=void 0,this._skills=[],this._resultTimeoutMs=null!==(t=this._params.resultTimeoutMs)&&void 0!==t?t:2e4,this._contextTimeoutMs=null!==(n=this._params.contextTimeoutMs)&&void 0!==n?n:2e4,this._historyTimeoutMs=null!==(i=this._params.historyTimeoutMs)&&void 0!==i?i:2e4,this._cheetahAckTimeoutMs=null!==(r=this._params.cheetahAckTimeoutMs)&&void 0!==r?r:2e4,this._monitoringService=null!==(s=this._params.monitoringService)&&void 0!==s?s:_.g.getInstance(),this._logger=null!==(o=this._params.logger)&&void 0!==o?o:new w.W(W.name),this.session=this._session.view(),this._handleCAPIMessage=e=>{switch(e.action){case"error":return this._handleError(e);case"cheetah":return this._handleCheetahAck(e);case"cheetah:setContext":return this._handleCheetahSetContext(e);case"cheetah:chunk":return this._handleCheetahChunk(e);case"cheetah:result":return this._handleCheetahResult(e);case"cheetah:error":return this._handleCheetahError(e);case"cheetah:setUserState":return this._handleCheetahSetUserState(e);case"cheetah:searchReferencesResult":return this._handleCheetahSearchReferencesResult(e);case"show_survey":return;case"cheetah:invalidateContext":return this._getContext();case"cheetah:setHistory":return this._handleCheetahSetHistory(e);default:return(0,a.Rz)(e)}},(0,b.Gh)(this._params.startSessionOptions)){const e=this._params.startSessionOptions.selectedRange;(0,k.tt)("getText",this._params.textEditorService.getText(this._params.startSessionOptions.selectedRange),this._logger,(t=>this._init({selectedRange:e,selectedText:t})))}else this._init()}_init(e){this._session.set({kind:"starting",mode:this._params.startSessionOptions.mode,selectedRange:g.fromNullable(null==e?void 0:e.selectedRange),selectedText:g.fromNullable(null==e?void 0:e.selectedText),quickReplyContext:g.fromNullable((0,b.jQ)(this._params.startSessionOptions)?this._params.startSessionOptions.quickReplyContext:void 0),writingExpertContext:g.fromNullable((0,b.dr)(this._params.startSessionOptions)?this._params.startSessionOptions.writingExpertContext:void 0),historyStatus:b.z_.HistoryStatus.unknown,knowledgeHubContext:g.fromNullable((0,b.LJ)(this._params.startSessionOptions)?this._params.startSessionOptions.knowledgeHubContext:void 0),error:g.none}),this._subs.push(this._params.capiService.relevantInboundCAPIMessages.subscribe((e=>this._handleCAPIMessage(e)))),this._subs.push(this._params.userService.user.view("dialect").subscribe((e=>h.wW(this._upstreamDialect)(b.LA.Dialect.Id.create(e))))),this._subs.push(this._upstreamDialect.subscribe((e=>this._handleUpstreamDialectChange(e)))),this._subs.push(this._session.subscribe((e=>this._logger.debug("Session updated:",e)))),this._subs.push(this._session.pipe((0,c.x)(((e,t)=>e.kind===t.kind)),(0,u.P)((e=>"started"===e.kind))).subscribe((()=>{this._params.trackingService.trackReadyToInteract()}))),this._startSession(this._params.startSessionOptions)}_startSession(e,t){(0,k.tt)("flush",this._params.textEditorService.flush(),this._logger,(()=>{const n=g.fromNullable((0,b.Gh)(e)?e.selectedRange:void 0),i=function(e){const t=(0,a.zG)(e,g.fromPredicate((e=>(0,b.e7)(e)&&!!e.documentUrl)),g.map((e=>e.documentUrl)),g.chain(g.fromNullable),g.chain(V),g.map((e=>({pageIdHash:e})))),n=(0,a.zG)(e,g.fromPredicate(b.jQ),g.map((e=>b.H3.toOuterContext(e.quickReplyContext))));return g.getMonoid((0,C.getFirstSemigroup)()).concat(t,n)}(e),r=g.fromNullable((0,b.dr)(e)?e.writingExpertContext:void 0),s={generationMode:N(e.mode),selectedRange:g.toUndefined(n),outerContext:g.toUndefined(i),stateBlob:t,metadata:e.metadata,previousText:(0,a.zG)(r,g.chain(b.nI.toPreviousText),g.toUndefined)};!(0,b.jQ)(e)&&this._params.skillService&&(0,k.tt)("getSkills",this._params.skillService.getSkills(),this._logger,(e=>{this._monitoringService.notify(b.BC.Info.GetSkillsSuccessful.create(e)),this._skills=e,(0,a.zG)(b.z_.toStarted(this._session.get()),g.filter((e=>!e.context.availableActions.some((e=>"skillAction"===e.kind)))),p.tap((e=>this._session.set(Object.assign(Object.assign({},e),{context:Object.assign(Object.assign({},e.context),{availableActions:e.context.availableActions.concat(this._skills.map(b.aU.SkillActionInput.fromSkill))})})))))}),(e=>this._monitoringService.notify(b.BC.Error.GetSkillsFailed.create(e)))),this._getContext(s)}))}submitAction(e,t){this._logger.debug("submitAction()",{actionValue:e,selectedVoice:t}),this._submitAction(e,void 0,void 0,t)}setVoiceProfile(e){return this._logger.debug("setVoiceProfile()",{voiceProfileSelections:e}),(0,a.zG)(O(this._session.get()),o.UI((t=>(this._session.set(Object.assign(Object.assign({},t),{voiceProfile:Object.assign(Object.assign({},t.voiceProfile),e),context:Object.assign(Object.assign({},t.context),{kind:"pending"})})),t))),o.tS((t=>(0,a.zG)(this._params.capiService.cheetahSetVoice({voice:{selectedStyle:e.selectedStyle,selectedTones:Array.from(e.selectedTonesPerStyle.get(e.selectedStyle)||[]),selectedRole:(0,a.zG)(e.selectedRole,g.toUndefined),needSetup:!1}}),o.Pd((e=>new Error(`CAPIService.cheetahSetVoice error: ${e.message}`)),(()=>!b.LA.Dialect.Id.eq.equals(t.voiceProfile.selectedDialect,e.selectedDialect))),o.tS((t=>t?i.g(o.qA)((0,a.zG)(this._params.capiService.set_context({documentContext:{dialect:e.selectedDialect}}),o.Vn((e=>new Error(`CAPIService.setContext error: ${e.message}`)))),(0,a.zG)(this._params.userService.setDialect(e.selectedDialect),o.Vn((e=>new Error(`CAPIService.setDialect error: ${e.message}`))))):o.of(null))),o.Pd((e=>(this._monitoringService.notify(b.SA.Error.SetVoiceProfileFailed.create(this._session.get().mode,e)),e)),a.Q1)))))}setNewVoiceProfile(e){var{selectedDialect:t}=e,n=L(e,["selectedDialect"]);return this._logger.debug("setNewVoiceProfile()",{dialect:t,voiceProfile:n}),(0,a.zG)(O(this._session.get()),o.UI((e=>(this._session.set(Object.assign(Object.assign({},e),{context:Object.assign(Object.assign({},e.context),{kind:"pending"})})),e))),o.tS((e=>(0,a.zG)(this._params.capiService.cheetahSetVoiceProfile({role:(0,a.zG)(n.selectedRole,g.toUndefined),isEnabledByDefault:n.isEnabledByDefault,profiles:n.profiles}),o.Pd((e=>new Error(`CAPIService.cheetahSetVoice error: ${e.message}`)),(()=>!b.LA.Dialect.Id.eq.equals(e.voiceProfile.selectedDialect,t))),o.tS((e=>e?i.g(o.qA)((0,a.zG)(this._params.capiService.set_context({documentContext:{dialect:t}}),o.Vn((e=>new Error(`CAPIService.setContext error: ${e.message}`)))),(0,a.zG)(this._params.userService.setDialect(t),o.Vn((e=>new Error(`CAPIService.setDialect error: ${e.message}`))))):o.of(null))),o.UI(a.Q1),P(this._logger,(e=>`SessionService.setVoiceProfile error: ${e.message}`))))))}stopInProgressResult(){return this._logger.debug("stopInProgressResult()"),(0,a.zG)(this._session.get(),o.DT(b.z_.isStartedWithInProgressResult,(()=>new Error("Session has no in-progress result."))),o.tS((e=>(this._clearResultRelatedTimeouts(),this._session.modify((t=>Object.assign(Object.assign({},t),{context:(0,a.zG)(e.results.length>0?this._extractLatestResultContext(e):this._extractInitialContext(),g.getOrElse((()=>e.context))),inProgressResult:b.x4.isInProgressPending(e.inProgressResult.value)?g.some(Object.assign(Object.assign({},e.inProgressResult.value),{kind:"inProgressInterrupted"})):b.x4.isInProgressInterrupted(e.inProgressResult.value)?e.inProgressResult:b.x4.isInProgressOngoing(e.inProgressResult.value)?g.none:(0,m.L0)(e.inProgressResult.value)}))),(0,a.zG)(e.inProgressResult.value,g.fromPredicate(b.x4.isInProgressOngoing),g.fold((()=>o.of(-1)),(e=>this._params.capiService.cheetahInterrupt({promptId:b.x4.Id.toPrimitive(e.id)}))))))),o.UI(a.Q1),P(this._logger,(e=>`SessionService.stopInProgressResult error: ${e.message}`)))}regenerateResult(e,t,n){this._logger.debug("regenerateResult()",{resultId:e,options:t,selectedVoice:n}),(0,a.zG)(b.z_.toStarted(this._session.get()),p.tapLeft((()=>this._logger.warn("regenerateResult() - trying to regenerate result with a session that is not `started`, skipping",{session:this._session.get(),resultId:e}))),g.chain((t=>(0,a.zG)(g.fromNullable(this._resultById.get(e)),g.filter(b.x4.isComplete),g.filter((e=>e.isRephraseable)),g.map((e=>({session:t,result:e}))),p.tapLeft((()=>{this._logger.warn("regenerateResult() - could not find a rephraseable result for provided result ID, skipping",{session:t,resultId:e}),this._monitoringService.notify(b.SA.Error.RegenerateResultFailed.create(this._session.get().mode,e,"not-found"))}))))),g.chain((({session:t,result:n})=>(0,a.zG)(n.source,g.map((e=>({resultSource:e,resultText:T(n)}))),p.tapLeft((()=>{this._logger.warn("regenerateResult() - trying to regenerate result without source action",{session:t,result:n}),this._monitoringService.notify(b.SA.Error.RegenerateResultFailed.create(t.mode,e,"no-source-action"))}))))),g.map((({resultSource:i,resultText:r})=>{const o=i.actionValue,c=g.getMonoid(s.jG()).concat,u=(0,a.zG)(o,g.fromPredicate(b.aU.isUserPromptActionValue),g.fold((0,a.a9)(o),(e=>Object.assign(Object.assign({},e),{omitReferenceIds:c(e.omitReferenceIds,t.omitReferenceIds)}))));this._submitAction(u,i.triggerContextId,{kind:"regular",text:r},n);const l=this._contextIdByResultId.get(e);this._params.trackingService.trackResultRephrase(l)})))}searchReferences(e){const t=this._session.get();"started"===t.kind?t.detectedReferences.has(e)||(this._session.set(Object.assign(Object.assign({},t),{detectedReferences:new Map(t.detectedReferences).set(e,g.none)})),this._setupCheetahAckHandler(b.SA.Error.SourceCommand.searchReferences,(t=>{this._searchReferencesUrlsById.set(t,e)})),(0,k.tt)("cheetahSearchReferences",this._params.capiService.cheetahSearchReferences({url:e}),this._logger)):this._logger.warn("searchReferences() - trying to search a reference with a session that is not `started`, skipping",{session:t})}dismissResult(e){this._logger.debug("dismissResult()",{resultId:e});const t=this._session.get();let n=null;if("started"===t.kind){if(this._resultById.delete(e)){const i=t.results.findIndex((t=>t.id===e));n=t.results[i];let r=t.context,s=null;if(0===i&&t.results.length>1){this._logger.debug("dismissResult() - dismissing latest result, will try to restore context from previous result",{session:t,resultId:e});const n=g.toUndefined(this._extractPreviousResultContext(t));n?(this._logger.debug("dismissResult() - found context for previous result, will restore its context",{session:t,resultId:e,previousResultContext:n}),r=n):t.results[1]&&b.x4.isHistory(t.results[1])&&(0,a.zG)(g.fromNullable(this._contextIdByResultId.get(t.results[1].id)),g.chain((e=>g.fromNullable(this._contextById.get(e)))),g.isNone)?s=t.results[1].id:this._logger.warn("dismissResult() - could not find context for previous result, context will not be updated",{session:t,resultId:e})}else if(1===t.results.length){const n=g.toNullable(this._extractInitialContext());n?(this._logger.debug("dismissResult() - dismissed all results, restoring initial context",{session:t,resultId:e,initialContext:n}),r=n):this._logger.warn("dimissResult() - dismissed all results, but there is no initial context to restore, keeping the latest context",{session:t,resultId:e})}this._session.set(Object.assign(Object.assign({},t),{context:Object.assign(Object.assign({},r),{kind:null!==s?"pending":r.kind,availableActions:s?[]:r.availableActions}),results:t.results.filter((t=>!b.x4.Id.eq.equals(t.id,e)))}));const o=this._contextIdByResultId.get(e);this._params.trackingService.trackResultDismiss(o,b.x4.isHistory(n)?e:void 0),"aiUsageNotification"===n.kind&&this._params.trackingService.trackAINotificationDismiss("document"),s&&this._getContext(void 0,s)}else this._logger.warn("dismissResult() - could not find result for provided result ID, skipping",{session:t,resultId:e})}else this._logger.warn("dismissResult() - trying to dismiss result with a session that is not `started`, skipping",{session:t,resultId:e})}dismissError(){this._logger.debug("dismissError()"),this._session.lens("error").set(g.none)}restoreHistory(){this._getHistory()}trackResultInsert(e){this._logger.debug("trackResultInsert()",{resultId:e});const t=this._resultById.get(e);if(t){const n=this._contextIdByResultId.get(e);this._params.trackingService.trackResultInsert(n,b.x4.isHistory(t)?t.id:void 0)}else this._logger.warn("trackResultInsert() - could not find result for provided result ID, skipping",{resultId:e})}trackResultCopy(e){this._logger.debug("trackResultCopy()",{resultId:e});const t=this._resultById.get(e);if(t){const n=this._contextIdByResultId.get(e);this._params.trackingService.trackResultCopy(n,b.x4.isHistory(t)?t.id:void 0)}else this._logger.warn("trackResultCopy() - could not find result for provided result ID, skipping",{resultId:e})}_trackResultGenerationCompleted(e){this._logger.debug("trackResultGenerationCompleted()",{resultId:e});const t=this._resultById.get(e);if(t){const n=this._contextIdByResultId.get(e);this._params.trackingService.trackResultGenerationCompleted(n,b.x4.isHistory(t)?t.id:void 0)}else this._logger.warn("trackResultGenerationCompleted() - could not find result for provided result ID, skipping",{resultId:e})}trackResultOffensive(e){this._logger.debug("trackResultOffensive()",{resultId:e});const t=this._resultById.get(e);if(t){const n=this._contextIdByResultId.get(e);this._params.trackingService.trackResultOffensive(n,b.x4.isHistory(t)?t.id:void 0)}else this._logger.warn("trackResultOffensive() - could not find result for provided result ID, skipping",{resultId:e})}trackActionsOffensive(){this._logger.debug("trackActionsOffensive()");const e=this._session.get();if("started"!==e.kind)return this._logger.warn("trackActionsOffensive() - tracking actions as offensive with a session that is not `started`, skipping");this._params.trackingService.trackActionsOffensive(e.context.id)}dispose(){this._subs.dispose()}_getContext(e,t){this._logger.debug("_getContext()",{data:e,fetchContextForHistoryCardId:t}),this._setupCheetahAckHandler(b.SA.Error.SourceCommand.getContext,(e=>{this._setupContextTimeout(b.SA.Error.SourceCommand.getContext),void 0!==t&&this._historyResultIdByGetContextMessageId.set(e,t)}));const n=this._session.get();(0,k.tt)("cheetahGetContext",this._params.capiService.cheetahGetContext(null!=e?e:{generationMode:N(n.mode),selectedRange:g.toUndefined(n.selectedRange),outerContext:g.toUndefined(G(n)),stateBlob:(0,a.zG)(b.z_.toStarted(n),g.fold(a.r5,(e=>this._stateBlobByContextId.get(e.context.id)))),previousText:"started"===n.kind&&n.results.length>0&&b.x4.isStandardCompletedResult(n.results[0])?F(n.results[0]):void 0}),this._logger,(()=>this._monitoringService.notify(b.SA.Info.GetContextSuccessful.create(this._session.get().mode))),(()=>this._monitoringService.notify(b.SA.Error.GetContextFailed.create(this._session.get().mode))))}_handleCheetahSetContext(e){var t;this._logger.debug("_handleCheetahSetContext()",{message:e}),this._clearContextTimeout();const n=this._session.get(),i=(0,a.zG)(g.fromNullable(null===(t=e.context)||void 0===t?void 0:t.voiceProfileSettings),g.fold((()=>U(e.context.voice,n,this._upstreamDialect.get())),(t=>E(t,e.context.voice,n,this._upstreamDialect.get())))),r={id:b._y.Id.create(e.context.id),availableActions:B(e.context.availableActions,this._skills,n.mode,n.selectedText),userPromptAction:M(e.context.promptAction,this._logger),quickRewriteAction:j(e.context.quickRewriteAction),intent:z(e.context.intent),documentOverview:H(e.context.documentOverview),specialView:g.fromNullable(e.context.specialView)},s=e.progressMessage?Object.assign(Object.assign({},r),{kind:"pending"}):Object.assign(Object.assign({},r),{kind:"received"});if(this._shouldSkipContextUpdate(e))return void this._logger.debug("skipping context update for missing history card");let o=!1;0===this._contextById.size&&b._y.isReceived(s)&&(o=!0,this._initialReceivedContext=s),this._contextById.set(s.id,s),this._stateBlobByContextId.set(s.id,e.context.stateBlob),this._bindContextToHistoryCardIfNeeded(e,s.id);const c=(0,a.zG)(n.writingExpertContext,g.chain(b.nI.getInitialResult),p.tap((e=>{this._resultById.set(e.id,e),this._contextIdByResultId.set(e.id,s.id)})),g.fold((()=>[]),(e=>[e])));if(this._session.set(Object.assign(Object.assign({},n),{kind:"started",voiceProfile:i,context:s,inProgressResult:"started"===n.kind?n.inProgressResult:g.none,results:"started"===n.kind?n.results:c,detectedReferences:"started"===n.kind?n.detectedReferences:new Map})),o&&b.wR.isQuickRewrite(n.mode)){const t=b.aU.QuickRewriteActionValue.fromInput(j(e.context.quickRewriteAction));this._logger.debug("_handleCheetahSetContext() - received initial context for quick rewrite session, submitting quick rewrite action",{session:n,message:e,quickRewriteAction:t}),this._submitAction(t)}}_shouldSkipContextUpdate(e){return(0,a.zG)(g.fromNullable(this._historyResultIdByGetContextMessageId.get(e.promptId)),g.fold(a.jv,(e=>(0,a.zG)(b.z_.toStarted(this._session.get()),g.map((e=>e.results)),g.fold(a.W8,(t=>!t.some((t=>t.id===e))))))))}_bindContextToHistoryCardIfNeeded(e,t){(0,a.zG)(g.fromNullable(this._historyResultIdByGetContextMessageId.get(e.promptId)),g.filter((e=>(0,a.zG)(g.fromNullable(this._contextIdByResultId.get(e)),g.fold(a.W8,(e=>void 0===this._contextById.get(e)))))),p.tap((e=>this._contextIdByResultId.set(e,t))))}_handleCheetahSetUserState(e){this._logger.debug("_handleCheetahUserState()",{message:e}),this._session.modify((t=>Object.assign(Object.assign({},t),{historyStatus:R(t,e.state.historyItems)})))}_getHistory(){if(this._logger.debug("_getHistory()"),void 0!==this._historyAckHandler)return this._logger.warn("_getHistory() called when a cheetah:getHistory request hasn't been ack'ed yet, skipping");this._historyAckHandler=()=>{this._historyAckHandler=void 0,this._setupHistoryTimeout()},this._setupCheetahAckHandler(b.SA.Error.SourceCommand.getHistory,this._historyAckHandler),this._session.lens("historyStatus").set(b.z_.HistoryStatus.historyRequested),(0,k.tt)("cheetahGetHistory",this._params.capiService.cheetahGetHistory(),this._logger,(()=>this._monitoringService.notify(b.SA.Info.GetHistorySuccessful.create(this._session.get().mode))),(()=>this._monitoringService.notify(b.SA.Error.GetHistoryFailed.create(this._session.get().mode))))}_handleCheetahSetHistory(e){void 0!==this._historyAckHandler&&(this._removeCheetahAckHandler(this._historyAckHandler),this._historyAckHandler=void 0),this._clearHistoryTimeout();const t=this._session.get();if("started"!==t.kind)return this._logger.warn("_handleCheetahSetHistory() - trying to handle `cheetah:setHistory` result with a session that is not `started`, skipping",{session:t});(0,a.zG)(e.cards,r.UI(b.x4.History.createFromCard),r.GY,s.c2,g.fold((()=>this._session.lens("historyStatus").set(b.z_.HistoryStatus.noHistory)),(e=>{e.forEach((e=>this._resultById.set(e.id,e))),this._session.set(Object.assign(Object.assign({},t),{context:Object.assign(Object.assign({},t.context),{kind:"pending",availableActions:[]}),historyStatus:b.z_.HistoryStatus.historyRestored,results:[...t.results,...e]})),this._getContext(void 0,e[0].id)})))}_handleCheetahChunk(e){this._logger.debug("_handleCheetahChunk()",{message:e});const t=this._session.get();if("started"!==t.kind)return this._logger.warn("_handleCheetahChunk() - received chunk with a session that is not `started`, skipping",{session:t,message:e});const n=b.x4.Id.create(e.promptId);(0,a.zG)(t.inProgressResult,g.filter(b.x4.isInProgressOngoing),g.filter((e=>b.x4.Id.eq.equals(e.id,n))),g.fold((()=>{const e=(0,a.zG)(t.inProgressResult,g.filter(b.x4.isInProgressOngoing),g.map((e=>e.id)));this._monitoringService.notify(b.SA.Warning.UnexpectedChunkReceived.create(this._session.get().mode,e,n))}),(n=>{this._clearResultRelatedTimeouts(),this._session.set(Object.assign(Object.assign({},t),{inProgressResult:g.some(Object.assign(Object.assign({},n),{text:n.text+e.token}))})),this._setupResultTimeout()})))}_handleCheetahResult(e){this._logger.debug("_handleCheetahResult()",{message:e});const t=this._session.get();if("started"!==t.kind)return this._logger.warn("_handleCheetahResult() - received result with a session that is not `started`, skipping",{session:t,message:e});const n=b.x4.Id.create(e.promptId);(0,a.zG)(t.inProgressResult,g.filter(b.x4.isInProgressOngoing),g.filter((e=>b.x4.Id.eq.equals(e.id,n))),g.fold((()=>{const e=(0,a.zG)(t.inProgressResult,g.filter(b.x4.isInProgressOngoing),g.map((e=>e.id)));this._monitoringService.notify(b.SA.Warning.UnexpectedResultReceived.create(this._session.get().mode,e,n))}),(n=>{var i,r,s,o;if(this._clearResultRelatedTimeouts(),e.error||!e.text||""===e.text.plain){const n=e.error?b.JZ.create(e.error):b.JZ.createEmptyResultError();this._logger.warn("_handleCheetahResult() - received result with error, adding error to session",{session:t,message:e,error:n}),this._session.set(Object.assign(Object.assign({},t),{inProgressResult:g.none,error:g.some(n)}))}else if(e.text.interrupted)this._logger.debug("_handleCheetahResult() - received result with interrupted text, skipping",{session:t,message:e});else{let c,u,l,d;if("aiUsageAlert"===(null===(r=null===(i=e.context)||void 0===i?void 0:i.specialView)||void 0===r?void 0:r.kind))c=b.x4.AIUsageNotification.fromInProgressResult(n,e.text.plain);else{const t=(0,a.zG)(n.source,g.map((e=>e.actionValue.generatesTextType)),g.filter(p.contains(S.yb.cX.Insertable)),g.map((()=>b.x4.PrimaryAction.insert))),i=g.isSome(t);c=Object.assign(Object.assign({},n),{text:e.text.plain,kind:"complete",timestamp:Date.now(),replacementDelta:b.x4.ResultDelta.createFromResultMessage(e),primaryAction:t,isRephraseable:i,references:(0,a.zG)(g.fromNullable(e.references),g.map((t=>t.map((t=>{var n;return Object.assign(Object.assign({},t),{id:b.s3.Id.create(t.id),url:g.fromNullable(t.url),contextText:(0,a.zG)(g.fromNullable(null===(n=e.metadata)||void 0===n?void 0:n.knowledge_engine_references),g.chainNullableK((e=>{const n=Array.isArray(e)?e.find((e=>e.id===t.id)):void 0,i=null==n?void 0:n.contextText;return"string"==typeof i?i:void 0})))})}))))),changesSummary:g.fromNullable(e.changesSummary)})}this._logger.debug("_handleCheetahResult() - received complete result, saving complete result into history",{session:t,message:e,result:c}),e.context?(l=(null===(s=e.context)||void 0===s?void 0:s.voiceProfileSettings)?E(null===(o=e.context)||void 0===o?void 0:o.voiceProfileSettings,e.context.voice,t,this._upstreamDialect.get()):U(e.context.voice,t,this._upstreamDialect.get()),u={kind:"received",id:b._y.Id.create(e.context.id),availableActions:B(e.context.availableActions,this._skills,t.mode,t.selectedText),userPromptAction:M(e.context.promptAction,this._logger),intent:z(e.context.intent),documentOverview:H(e.context.documentOverview),specialView:g.fromNullable(e.context.specialView)},d=e.context.stateBlob,this._logger.debug("_handleCheetahResult() - received result with context, will update voice profile and context accordingly",{session:t,message:e,voiceProfile:l,context:u})):(this._logger.warn("_handleCheetahResult() - received result without context, keeping latest voice profile and context",{session:t,message:e}),l=t.voiceProfile,u=t.context,d=this._stateBlobByContextId.get(t.context.id)),this._contextById.set(u.id,u),void 0!==d&&this._stateBlobByContextId.set(u.id,d),this._resultById.set(c.id,c),this._contextIdByResultId.set(c.id,u.id),this._session.set(Object.assign(Object.assign({},t),{voiceProfile:l,context:u,inProgressResult:g.none,results:[c,...t.results]})),this._trackResultGenerationCompleted(c.id)}})))}_handleCheetahSearchReferencesResult(e){const t=this._session.get();if("started"===t.kind){const n=this._searchReferencesUrlsById.get(e.promptId);if(n){const i=e.references[0];i&&this._session.set(Object.assign(Object.assign({},t),{detectedReferences:new Map(t.detectedReferences).set(n,g.some(b.s3.create(i)))}))}else this._logger.warn("_handleCheetahSearchReferencesResult() - trying to handle a search references result that did not have a corresponding cheetah:searchReferences request, skipping",{message:e})}else this._logger.warn("_handleCheetahSearchReferencesResult() - trying to handle a search references result with a session that is not `started`, skipping",{session:t})}_handleCheetahError(e){this._logger.debug("_handleCheetahError",{message:e}),this._clearAllTimeouts();const t=b.JZ.create(e.error);this._logger.warn("_handleCheetahError - received error, adding error to session",{error:t}),this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:g.none,error:g.some(t)})))}_handleUpstreamDialectChange(e){this._logger.debug("_handleUpstreamDialectChange()",{upstreamDialect:e});const t=this._session.get();if("started"===t.kind){const n=b.LA.Dialect.Id.create(e);this._logger.debug("_handleUpstreamDialectChange() - dialect changed on upstream services, updating selected dialect on voice profile",{session:t,selectedDialect:n}),this._session.set(Object.assign(Object.assign({},t),{voiceProfile:Object.assign(Object.assign({},t.voiceProfile),{selectedDialect:n})}))}}_handleCheetahAck(e){this._logger.debug("_handleCheetahAck()",{message:e}),this._clearCheetahAckTimeout(),this._cheetahAckIds.add(e.id);const t=this._cheetahAckHandlers.length>0?this._cheetahAckHandlers[0]:void 0;t&&(this._logger.debug("_handleCheetahAck() - extracting `cheetah:ack` handler from queue and executing it",{message:e,cheetahAckHandlers:this._cheetahAckHandlers}),this._cheetahAckHandlers=this._cheetahAckHandlers.slice(1),t(e.id))}_handleError(e){if(this._cheetahAckIds.has(e.id))if(this._clearAllTimeouts(),e.error===l.jK.SESSION_NOT_INITIALIZED){const t=(0,a.zG)(b.z_.toStarted(this._session.get()),g.map((e=>this._stateBlobByContextId.get(e.context.id))),g.toUndefined);this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:g.none}))),this._startSession(this._params.startSessionOptions,t),this._monitoringService.notify(b.SA.Warning.CAPIErrorHandled.create(this._session.get().mode,e))}else{const t=b.JZ.createCriticalError((0,a.zG)(b.z_.toStarting(this._session.get()),g.isSome));this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:g.none,error:g.some(t)}))),this._monitoringService.notify(b.SA.Error.CAPIErrorUnhandled.create(this._session.get().mode,e))}else this._monitoringService.notify(b.SA.Error.CAPIErrorUnhandled.create(this._session.get().mode,e))}_submitAction(e,t,n,i){var r;this._logger.debug("_submitAction()",{actionValue:e,triggerContextId:t,previousText:n,selectedVoice:i});const c=this._session.get();if("started"===c.kind){const u=c.context.id,l=this._stateBlobByContextId.get(u);if(void 0===l)return this._logger.warn("_submitAction() - cannot find state blob for context ID, skipping",{session:c,contextId:u,triggerContextId:t,contextStateBlob:l});const d="aiUsageNotification"===(null===(r=c.results[0])||void 0===r?void 0:r.kind)?c.results.slice(1):c.results;this._session.set(Object.assign(Object.assign({},c),{results:d,historyStatus:b.z_.HistoryStatus.restoreDisabled,context:Object.assign(Object.assign({},c.context),{kind:"pending"}),inProgressResult:g.isSome(e.generatesTextType)?g.some({kind:"inProgressPending",header:{label:b.aU.isUserPromptActionValue(e)?e.arg.value:e.label,iconUrl:b.aU.isUserPromptActionValue(e)||""===e.iconUrl.trim()?g.none:g.some(e.iconUrl),copiablePrompt:b.aU.isUserPromptActionValue(e)&&""!==e.arg.value.trim()?g.some(e.arg.value):g.none},text:"",source:g.some({triggerContextId:null!=t?t:u,actionValue:e})}):g.none,error:g.none})),this._setupCheetahAckHandler(b.SA.Error.SourceCommand.action,(e=>{(0,a.zG)(b.z_.toStarted(this._session.get()),g.chain((e=>e.inProgressResult)),g.filter((0,v.Kg)(b.x4.isInProgressPending,b.x4.isInProgressInterrupted)),g.fold((()=>(this._logger.warn("received `cheetah:ack` related to in-progress-pending result but we don't have an in-progress-pending result, skipping",{ackId:e}),o.of(void 0))),(t=>{if(b.x4.isInProgressInterrupted(t))return this._logger.info("received `cheetah:ack` related to in-progress-interrupted result, sending `cheetah:interrupt`",{ackId:e}),this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:g.none}))),this._params.capiService.cheetahInterrupt({promptId:e});if(b.x4.isInProgressPending(t)){this._setupContextTimeout(b.SA.Error.SourceCommand.action),this._setupResultTimeout();const n=Object.assign(Object.assign({},t),{kind:"inProgressOngoing",id:b.x4.Id.create(e)});return this._logger.debug("received `cheetah:ack` related to in-progress-pending result, transitioning result to in-progress-ongoing",{ackId:e,inProgressResult:n}),this._resultById.set(n.id,n),this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:g.some(n)}))),o.of(void 0)}(0,m.L0)(t)})))()}));const h=Object.assign({contextId:u,triggerContextId:null!=t?t:u,actionId:e.id,args:b.aU.isUserPromptActionValue(e)?[{name:e.arg.id,value:e.arg.value}]:(0,a.zG)(s.c2(e.args),g.fold((()=>[]),(e=>e.map((e=>({name:e.id,value:e.value})))))),stateBlob:l,previousText:null!=n?n:c.results.length>0&&b.x4.isStandardCompletedResult(c.results[0])?F(c.results[0]):void 0},i?{metadata:{selectedVoice:i}}:null),f=(0,a.zG)(e,g.fromPredicate(b.aU.isUserPromptActionValue),g.fold((0,a.a9)(h),(e=>Object.assign(Object.assign({},h),{useReferences:g.toUndefined(e.useReferences),omitReferenceIds:g.toUndefined(e.omitReferenceIds)}))));this._logger.debug("_submitAction() - sending `cheetah:action` to CAPI",{data:f}),(0,k.tt)("cheetahAction",this._params.capiService.cheetahAction(f),this._logger,(()=>this._monitoringService.notify(b.SA.Info.ActionSuccessful.create(this._session.get().mode,e.id))),(()=>this._monitoringService.notify(b.SA.Error.ActionFailed.create(this._session.get().mode,e.id))))}else this._logger.warn("_submitAction() - submitting action with a session that is not `started`, skipping",{session:c,actionValue:e,triggerContextId:t})}_extractLatestResultContext(e){return this._extractContextFromResults(e,0)}_extractPreviousResultContext(e){return this._extractContextFromResults(e,1)}_extractContextFromResults(e,t){const n=(0,a.zG)(g.fromNullable(e.results[t]),g.map((e=>e.id)),g.chain((e=>g.fromNullable(this._contextIdByResultId.get(e)))),g.chain((e=>g.fromNullable(this._contextById.get(e)))));return g.isNone(n)&&this._logger.warn("_extractContextFromResults() - could not find context for result",{session:e,resultIndex:t}),n}_extractInitialContext(){return null!==this._initialReceivedContext?g.some(this._initialReceivedContext):(this._logger.warn("_extractInitialContext() - could not find initial context"),g.none)}_setupResultTimeout(){this._clearResultTimeout(),this._resultTimeout=f.H(this._resultTimeoutMs).subscribe((()=>{this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:g.none,error:g.some(b.JZ.createCriticalError((0,a.zG)(b.z_.toStarting(this._session.get()),g.isSome)))}))),this._monitoringService.notify(b.SA.Error.WaitForResultTimeout.create(this._session.get().mode))}))}_setupContextTimeout(e){this._logger.debug("_setupContextTimeout()",{sourceCommand:e}),this._clearContextTimeout(),this._contextTimeout=f.H(this._contextTimeoutMs).subscribe((()=>{const t=b.JZ.createCriticalError((0,a.zG)(b.z_.toStarting(this._session.get()),g.isSome));this._logger.warn("waited too long to receive `cheetah:setContext`, adding error to session",{error:t}),this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:g.none,error:g.some(t)}))),this._monitoringService.notify(b.SA.Error.WaitForContextTimeout.create(this._session.get().mode,e))}))}_setupHistoryTimeout(){this._clearHistoryTimeout(),this._historyTimeout=f.H(this._historyTimeoutMs).subscribe((()=>{const e=b.JZ.createCriticalError((0,a.zG)(b.z_.toStarting(this._session.get()),g.isSome));this._logger.warn("waited too long to receive `cheetah:setHistory`, adding error to session",{error:e}),this._session.modify((t=>Object.assign(Object.assign({},t),{inProgressResult:g.none,error:g.some(e)}))),this._monitoringService.notify(b.SA.Error.WaitForHistoryTimeout.create(this._session.get().mode))}))}_setupCheetahAckTimeout(e){this._logger.debug("_setupCheetahAckTimeout()",{sourceCommand:e}),this._clearCheetahAckTimeout(),this._cheetahAckTimeout=f.H(this._cheetahAckTimeoutMs).subscribe((()=>{const t=b.JZ.createCriticalError((0,a.zG)(b.z_.toStarting(this._session.get()),g.isSome));this._logger.warn("waited too long to receive an ACK for a `cheetah:*` command, adding error to session",{error:t}),this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:g.none,error:g.some(t)}))),this._monitoringService.notify(b.SA.Error.WaitForAckTimeout.create(this._session.get().mode,e))}))}_clearResultTimeout(){var e;null===(e=this._resultTimeout)||void 0===e||e.unsubscribe(),this._resultTimeout=void 0}_clearContextTimeout(){var e;null===(e=this._contextTimeout)||void 0===e||e.unsubscribe(),this._contextTimeout=void 0}_clearHistoryTimeout(){var e;null===(e=this._historyTimeout)||void 0===e||e.unsubscribe(),this._historyTimeout=void 0}_clearCheetahAckTimeout(){var e;null===(e=this._cheetahAckTimeout)||void 0===e||e.unsubscribe(),this._cheetahAckTimeout=void 0}_clearResultRelatedTimeouts(){this._clearContextTimeout(),this._clearResultTimeout(),this._clearCheetahAckTimeout()}_clearAllTimeouts(){this._clearResultTimeout(),this._clearContextTimeout(),this._clearHistoryTimeout(),this._clearCheetahAckTimeout()}_setupCheetahAckHandler(e,t){this._setupCheetahAckTimeout(e),this._cheetahAckHandlers.push(t)}_removeCheetahAckHandler(e){this._cheetahAckHandlers=this._cheetahAckHandlers.filter((t=>t!==e)),0===this._cheetahAckHandlers.length&&this._clearCheetahAckTimeout()}}},9137:(e,t,n)=>{n.d(t,{c:()=>o});var i=n(13004),r=n(4283),s=n(75055);class o{constructor(e,t=new s.W(o.name)){this._capiService=e,this._logger=t}trackResultInsert(e,t){this._logger.debug("trackResultInsert()",{contextId:e,historyResultId:t}),e||this._logger.warn("trackResultInsert() - tracking result insert without context"),this._trackUxInteraction({kind:"result",userAction:r.Z7.Result.UserAction.insert},e,t)}trackResultOffensive(e,t){this._logger.debug("trackResultOffensive()",{contextId:e,historyResultId:t}),e||this._logger.warn("trackResultOffensive() - tracking result offensive without context"),this._trackUxInteraction({kind:"result",userAction:r.Z7.Result.UserAction.offensive},e,t)}trackResultDismiss(e,t){this._logger.debug("trackResultDismiss()",{contextId:e,historyResultId:t}),e||this._logger.warn("trackResultDismiss() - tracking result dismiss without context"),this._trackUxInteraction({kind:"result",userAction:r.Z7.Result.UserAction.dismiss},e,t)}trackResultRephrase(e){this._logger.debug("trackResultRephrase()",{contextId:e}),e||this._logger.warn("trackResultRephrase() - tracking result rephrase without context"),this._trackUxInteraction({kind:"result",userAction:r.Z7.Result.UserAction.rephrase},e)}trackResultCopy(e,t){this._logger.debug("trackCopy()"),this._trackUxInteraction({kind:"result",userAction:r.Z7.Result.UserAction.copy},e,t)}trackResultGenerationCompleted(e,t){this._logger.debug("trackResultGenerationCompleted()"),this._trackUxInteraction({kind:"result",userAction:r.Z7.Result.UserAction.generationCompleted},e,t)}trackVoiceProfileOpen(e){this._logger.debug("trackVoiceProfileOpen()",{source:e}),this._trackUxInteraction({kind:"voiceProfile",userAction:"toolbar"===e?r.Z7.VoiceProfile.UserAction.open:r.Z7.VoiceProfile.UserAction.openFromBanner})}trackVoiceProfileSkip(){this._logger.debug("trackVoiceProfileSkip()"),this._trackUxInteraction({kind:"voiceProfile",userAction:r.Z7.VoiceProfile.UserAction.skip})}trackActionsOpenStore(){this._logger.debug("trackActionsOpenStore()"),this._trackUxInteraction({kind:"actions",userAction:r.Z7.Actions.UserAction.openStore})}trackActionsOffensive(e){this._logger.debug("trackActionsOffensive()"),e||this._logger.warn("trackActionsOffensive() - tracking actions offensive without context"),this._trackUxInteraction({kind:"actions",userAction:r.Z7.Actions.UserAction.offensive},e)}trackPromptSearch(){this._logger.debug("trackPromptSearch()"),this._trackUxInteraction({kind:"prompt",userAction:r.Z7.Prompt.UserAction.search})}trackUsageInfoClick(){this._logger.debug("trackUsageInfoClick()"),this._trackUxInteraction({kind:"usageInfo",userAction:r.Z7.UsageInfo.UserAction.click})}trackUsageInfoHover(){this._logger.debug("trackUsageInfoHover()"),this._trackUxInteraction({kind:"usageInfo",userAction:r.Z7.UsageInfo.UserAction.hover})}trackHistoryButtonView(){this._logger.debug("trackHistoryButtonView()"),this._trackUxInteraction({kind:"historyButton",userAction:r.Z7.HistoryButton.UserAction.view})}trackOnboardingPopupView(){this._logger.debug("trackOnboardingPopupView()"),this._trackUxInteraction({kind:"onboardingPopup",userAction:r.Z7.Onboarding.UserAction.view})}trackOnboardingPopupSkip(){this._logger.debug("trackOnboardingPopupSkip()"),this._trackUxInteraction({kind:"onboardingPopup",userAction:r.Z7.Onboarding.UserAction.skip})}trackOnboardingPopupNext(){this._logger.debug("trackOnboardingPopupNext()"),this._trackUxInteraction({kind:"onboardingPopup",userAction:r.Z7.Onboarding.UserAction.next})}trackBTSOnboardingPopupView(){this._logger.debug("trackBTSOnboardingPopupView()"),this._trackUxInteraction({kind:"BTSonboardingPopup",userAction:r.Z7.Onboarding.UserAction.view})}trackBTSOnboardingPopupSkip(){this._logger.debug("trackBTSOnboardingPopupSkip()"),this._trackUxInteraction({kind:"BTSonboardingPopup",userAction:r.Z7.Onboarding.UserAction.skip})}trackBTSOnboardingPopupNext(){this._logger.debug("trackBTSOnboardingPopupNext()"),this._trackUxInteraction({kind:"BTSonboardingPopup",userAction:r.Z7.Onboarding.UserAction.next})}trackOnboardingPromptsTooltipView(){this._logger.debug("trackOnboardingPromptsTooltipView()"),this._trackUxInteraction({kind:"onboardingPromptsTooltip",userAction:r.Z7.Onboarding.UserAction.view})}trackOnboardingReviewTooltipView(){this._logger.debug("trackOnboardingReviewTooltipView()"),this._trackUxInteraction({kind:"onboardingReviewTooltip",userAction:r.Z7.Onboarding.UserAction.view})}trackOnboardingRewriteTooltipView(){this._logger.debug("trackOnboardingRewriteTooltipView()"),this._trackUxInteraction({kind:"onboardingRewriteTooltip",userAction:r.Z7.Onboarding.UserAction.view})}trackOnboardingKnowledgeHubTooltipView(){this._logger.debug("trackOnboardingRewriteTooltipView()"),this._trackUxInteraction({kind:"onboardingKnowledgeHubTooltip",userAction:r.Z7.Onboarding.UserAction.view})}trackOnboardingReferencesTooltipView(){this._logger.debug("trackOnboardingReferencesTooltipView()"),this._trackUxInteraction({kind:"onboardingReferencesTooltip",userAction:r.Z7.Onboarding.UserAction.view})}trackOnboardingHistoryTooltipView(){this._logger.debug("trackOnboardingHistoryTooltipView()"),this._trackUxInteraction({kind:"onboardingHistoryTooltip",userAction:r.Z7.Onboarding.UserAction.view})}trackAssistantClose(){this._logger.debug("trackAssistantClose()"),this._trackUxInteraction({kind:"assistant",userAction:r.Z7.Assistant.UserAction.close})}trackVoiceProfileRemoveTag(){this._logger.debug("trackVoiceProfileRemoveTag()"),this._trackUxInteraction({kind:"voiceProfile",userAction:r.Z7.VoiceProfile.UserAction.removeVoiceTag})}trackVoiceProfileKeepTag(){this._logger.debug("trackVoiceProfileKeepTag()"),this._trackUxInteraction({kind:"voiceProfile",userAction:r.Z7.VoiceProfile.UserAction.keepVoiceTag})}trackAINotificationDismiss(e){this._logger.debug("trackAINotificationDismiss()"),this._trackUxInteraction({kind:"aiUsageNotification",userAction:"document"===e?r.Z7.AIUsageNotification.UserAction.dontShowOnDocument:r.Z7.AIUsageNotification.UserAction.dontShowForever})}trackReadyToInteract(){this._logger.debug("trackReadyToInteract()"),this._trackUxInteraction({kind:"assistant",userAction:r.Z7.Assistant.UserAction.readyToInteract})}_trackUxInteraction(e,t,n){const s=r.Z7.getComponentId(e,t,n),o=r.Z7.getUserAction(e);this._logger.debug("_trackUxInteraction() - sending `user_action` to CAPI",{componentId:s,userAction:o,uxInteraction:e,contextId:t}),(0,i.tt)("sendUserAction",this._capiService.user_action({componentId:s,userAction:o}),this._logger)}}},36582:(e,t,n)=>{n.d(t,{p:()=>h});var i=n(5114),r=n(57050),s=n(80800),o=n(9922),a=n(85985),c=n(38983),u=n(4283),l=n(13004),d=n(97834);class h{constructor(e){var t;this._params=e,this._subs=new o.w.Keeper,this._activeSurvey=c.h.create(i.none),this.activeSurvey=this._activeSurvey.view(),this._monitoringService=null!==(t=this._params.monitoringService)&&void 0!==t?t:d.g.getInstance(),this._init()}dispose(){this._subs.dispose()}submitSurveyResult(e){(0,l.tt)("submitSurveyResult",this._params.capiService.submit_survey_result({placement:e.placement,score:e.rating,stage:u.Bs.Stage.toCAPIStage(e.stage),open_answer:i.getOrElse((()=>""))(e.openAnswer),detailed_placement:e.detailedPlacement,type:e.type}),void 0,(()=>this._monitoringService.notify(u.wL.Info.SubmitSurveyInfo.create(e.type,e.placement,e.stage,!1,e.rating,i.getOrElse((0,r.a9)(""))(e.openAnswer),e.detailedPlacement))),(()=>this._monitoringService.notify(u.wL.Error.SubmitSurveyFailed.create(e.type,e.placement,e.detailedPlacement))))}dismissSurvey(e){(0,l.tt)("submitSurveyResult",this._params.capiService.submit_survey_result({placement:e.placement,score:"declined",stage:u.Bs.Stage.toCAPIStage(e.stage),detailed_placement:e.detailedPlacement,type:e.type}),void 0,(()=>this._monitoringService.notify(u.wL.Info.SubmitSurveyInfo.create(e.type,e.placement,e.stage,!0))),(()=>this._monitoringService.notify(u.wL.Error.SubmitSurveyFailed.create(e.type,e.placement,e.detailedPlacement))))}_init(){this._subs.push(this._params.capiService.relevantInboundCAPIMessages.pipe(a.h(u.JS.ShowSurvey.is)).subscribe((e=>this._handleShowSurvey(e))))}_handleShowSurvey(e){(0,r.zG)(e.survey,i.fromPredicate((e=>e.placement===s.v0.Survey.Data.BaseSurvey.Placement.ggo)),i.chain((e=>"open_answer_score"===e.type?i.some(e):i.none)),i.chain((e=>{var t;return"string"==typeof e.detailed_placement&&2===(null===(t=e.detailed_placement)||void 0===t?void 0:t.split(":").length)?i.some({survey:e,detailedPlacement:e.detailed_placement}):i.none})),i.chain((({survey:e,detailedPlacement:t})=>{const[n,r]=t.split(":"),s=Math.abs(Number.parseInt(r,10));return Number.isNaN(s)?i.none:i.some({survey:e,detailedPlacement:t,sessionId:n,resultId:u.x4.Id.create(s)})})),i.fold((()=>this._monitoringService.notify(u.wL.Warning.UnexpectedSurveyFormatReceived.create(e.survey.type,e.survey.placement,e.survey.detailed_placement))),(({survey:e,detailedPlacement:t,resultId:n})=>{this._activeSurvey.modify((()=>i.some({placement:e.placement,title:e.title,detailedPlacement:t,type:s.v0.Survey.Data.OpenAnswerScoreSurvey.type,resultId:n,maxScore:e.max_score,boxText:i.fromNullable(e.box_text),ratingLabels:e.score_labels,acknowledgmentTitle:i.fromNullable(e.acknowledgment_title),acknowledgment:i.fromNullable(e.acknowledgment),skipOpenAnswerFrom:e.skip_open_answer_from,openAnswer:i.fromNullable({placeholder:e.open_answer.placeholder,maxLen:e.open_answer.max_len,minLen:i.fromNullable(e.open_answer.min_len)})})))})))}}},13004:(e,t,n)=>{n.d(t,{Es:()=>i,BO:()=>s,eG:()=>W,E9:()=>g,ap:()=>h,l:()=>V,$d:()=>j,mA:()=>L,vY:()=>l,$Q:()=>u,JY:()=>U,C7:()=>p,Re:()=>d,xs:()=>D,uj:()=>R,ni:()=>Q,m:()=>T,NN:()=>m,tt:()=>J,Ly:()=>fe,Av:()=>he,HL:()=>ge,E:()=>f,Bk:()=>le,DO:()=>G,lA:()=>M,bB:()=>me,li:()=>ve,Tc:()=>pe});var i={};n.r(i),n.d(i,{baseButtonContentOverrideSpecificity:()=>re,buttonOverrideSpecificity:()=>oe,cheetahButtonContentOverrideSpecificity:()=>se,heightAndMinHeightRems:()=>ee,iconSizeRems:()=>te,repeatClassSelector:()=>ne,specificity:()=>ie,widthAndMinWidthRems:()=>X});var r=n(62172);const s=Object.assign(Object.assign({},r),{BrandGreen60:"#018374",BrandGreen80:"#017467",BorderBaseSubduedColor:"#CDD1DC",TextBaseSubduedColor:"#646B81",TextBaseDefault:"#161719"});var o=n(31699),a=n(77176);function c(e){const t=function(e){const t=e.ownerDocument;if(t)return t;throw new Error("target does not have ownerDocument")}(e).defaultView;if(t)return t;throw new Error("active document is detached from a window")}function u(e,t=3){if(e&&t>0){const n=function(e){const t=(null===(r=null===(i=(n=e).ownerDocument)||void 0===i?void 0:i.defaultView)||void 0===r?void 0:r.getComputedStyle(n))||null;var n,i,r;return t?"auto"===t.overflow||"scroll"===t.overflow||"auto"===t.overflowY||"scroll"===t.overflowY||"auto"===t.overflowX||"scroll"===t.overflowX:null}(e);return n?e:null===n?null:u(null==e?void 0:e.parentElement,t-1)}return null}function l(e){var t,n;return null===(n=(null===(t=e.activeElement)||void 0===t?void 0:t.shadowRoot)||e)||void 0===n?void 0:n.activeElement}function d(e){return e instanceof HTMLElement}const h=["b","i"];function f(e,t=h){return"string"==typeof e?{dangerouslySetInnerHTML:{__html:(0,o.sanitize)(e,{ALLOWED_TAGS:Array.from(t)})}}:{dangerouslySetInnerHTML:e.pipe(a.U((e=>({__html:(0,o.sanitize)(e,{ALLOWED_TAGS:Array.from(t)})}))))}}var g;function p(e=document){return{top:0,left:0,height:e.documentElement.clientHeight,width:e.documentElement.clientWidth}}function m(e,t){return n=>{const i=function(e,t){const n=e.left<t.left?t.left:e.left+e.width>t.left+t.width?t.left+t.width-e.width:e.left,i=e.top<t.top?t.top:e.top+e.height>t.top+t.height?t.top+t.height-e.height:e.top;return Object.assign(Object.assign({},e),{left:n,top:i})}({left:e.left+n.x,top:e.top+n.y,width:e.width,height:e.height},t);return{x:i.left-e.left,y:i.top-e.top}}}!function(e){e.fromCartesian=function({x:e,y:t}){return{top:t,left:e}},e.l1Distance=function(e,t){return Math.abs(e.top-t.top)+Math.abs(e.left-t.left)}}(g||(g={}));var v,y=n(57050),b=n(85985),S=n(28043),k=n(66310),w=n(49708),_=n(2834),x=n(2768),I=n(55721),A=n(39719),C=n(67434);function R(){return(0,y.ls)(b.h((e=>!!e)),S.x(),k.w((e=>w.R(e,"mousedown").pipe(b.h((e=>!e.button)),_.b((e=>e.preventDefault())),a.U((t=>({element:e,startPos:{x:t.clientX,y:t.clientY}}))),k.w((e=>w.R(c(e.element),"mousemove").pipe(x.R(w.R(c(e.element),"mouseup",{capture:!0})),I.p(10),a.U((({clientX:t,clientY:n})=>({kind:"dragInProgress",element:e.element,startPos:e.startPos,delta:{x:t-e.startPos.x,y:n-e.startPos.y}}))),A.l({kind:"dragDone"}))))))),C.R(((e,t)=>"dragDone"===t.kind?{translate:e.translate,lastTranslate:e.translate,dragging:!1,dragStart:!1,dragEnd:e.dragging}:{dragging:!0,dragStart:!e.dragging,dragEnd:!1,lastTranslate:e.lastTranslate,translate:{x:t.delta.x+e.lastTranslate.x,y:t.delta.y+e.lastTranslate.y}}),v.create()))}function T(e){return t=>{(null==t?void 0:t.isTrusted)&&(null==e||e(t))}}!function(e){e.create=function(){return{translate:{x:0,y:0},lastTranslate:{x:0,y:0},dragging:!1,dragStart:!1,dragEnd:!1}}}(v||(v={}));var P=n(5114),O=n(45701),E=n(64015);function U(){return O.contramap((({matchScore:e})=>e))(O.ordNumber)}function B(e){return e.split(/\s+/).map((e=>e.trim())).filter((e=>""!==e))}function M(e,t,n){const i=B(e),r=[...B(t),...(0,y.zG)(n,E.tS((e=>B(e))))],s=i.map((()=>null));let o=0;for(const e of r){if(o>=i.length)break;e.toLowerCase().includes(i[o].toLowerCase())&&(s[o]=0,++o)}return s.includes(null)?P.none:P.some(s.map((e=>null!=e?e:0)).reduce(((e,t)=>e+t),0))}const j=()=>e=>e;var z=n(69243),F=n(8709),H=n(36991);const N=z.readonly(z.type({ops:z.readonlyArray(z.union([z.type({insert:z.readonly(z.string)}),z.type({retain:z.readonly(z.number)}),z.type({delete:z.readonly(z.number)})]))}));function G(e){return(0,y.zG)(e,P.fromPredicate(N.is),P.map((e=>new F.i([...e.ops]))))}function V(e,t){return e.reduce(((e,t)=>(H.s.isInsertString(t)?(e.text=`${e.text.substring(0,e.index)}${t.insert}${e.text.substring(e.index)}`,e.index+=t.insert.length):H.s.isDelete(t)?e.text=`${e.text.substring(0,e.index)}${e.text.substring(e.index+t.delete)}`:H.s.isRetain(t)?e.index+=t.retain:function(e){var t;return H.s.isInsertEmbed(e)&&!0===(null===(t=e.insert)||void 0===t?void 0:t.linebreak)}(t)&&(e.text=`${e.text.substring(0,e.index)}\n${e.text.substring(e.index)}`,e.index+=1),e)),{text:t,index:0}).text}function D(e){return Number.isInteger(e)&&e>=0&&e<10}function L(e){return["zero","one","two","three","four","five","six","seven","eight","nine"][e]}var W,K=n(95195),q=n(50685),Z=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};function J(e,t,n,i,r){return Z(this,void 0,void 0,(function*(){try{const s=yield t();K.isLeft(s)?(null==n||n.error("runTaskEither() - error running task",{taskName:e,result:s}),null==r||r(s.left)):(null==n||n.debug("runTaskEither() - task successful",{taskName:e,result:s.right}),null==i||i(s.right))}catch(t){null==n||n.error("runTaskEither() - promise rejection running task",q.jI.isErrorLike(t)?t:new Error(String(t)),{taskName:e})}}))}!function(e){e.set=function(e,t){return n=>Object.assign(Object.assign({},n),{[e]:t})}}(W||(W={}));var $=n(48044);function Q(e){return(t,n)=>i=>(0,y.zG)(i,$.cq(e)(t,(0,y.ls)(P.some,n)),P.getOrElse((()=>(0,y.zG)(i,$.ZQ(e)(t,n(P.none))))))}var Y=n(89894);function X(e){return{width:Y.ux.rem(e),minWidth:Y.ux.rem(e)}}function ee(e){return{height:Y.ux.rem(e),minHeight:Y.ux.rem(e)}}function te(e,t){return Object.assign(Object.assign({},X(e)),ee(null!=t?t:e))}function ne(e,t){return`.${e}`.repeat(t)}function ie(e,t,n){return{$nest:{[`&${ne(t,n)}`]:e}}}const re=6,se=re+1;function oe(e,t){return ie(e,t,se)}const ae=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function ce(e,t,n,i,r){let s,o,a,c,u,l,d,h,f,g,p,m,v;for(;r>=64;){for(s=t[0],o=t[1],a=t[2],c=t[3],u=t[4],l=t[5],d=t[6],h=t[7],g=0;g<16;g++)p=i+4*g,e[g]=(255&n[p])<<24|(255&n[p+1])<<16|(255&n[p+2])<<8|255&n[p+3];for(g=16;g<64;g++)f=e[g-2],m=(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10,f=e[g-15],v=(f>>>7|f<<25)^(f>>>18|f<<14)^f>>>3,e[g]=(m+e[g-7]|0)+(v+e[g-16]|0);for(g=0;g<64;g++)m=(((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+(u&l^~u&d)|0)+(h+(ae[g]+e[g]|0)|0)|0,v=((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+(s&o^s&a^o&a)|0,h=d,d=l,l=u,u=c+m|0,c=a,a=o,o=s,s=m+v|0;t[0]+=s,t[1]+=o,t[2]+=a,t[3]+=c,t[4]+=u,t[5]+=l,t[6]+=d,t[7]+=h,i+=64,r-=64}return i}class ue{constructor(){this.digestLength=32,this.blockSize=64,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}reset(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this}clean(){for(let e=0;e<this.buffer.length;e++)this.buffer[e]=0;for(let e=0;e<this.temp.length;e++)this.temp[e]=0;this.reset()}update(e,t=e.length){if(this.finished)throw new Error("SHA256: can't update because hash was finished.");let n=0;if(this.bytesHashed+=t,this.bufferLength>0){for(;this.bufferLength<64&&t>0;)this.buffer[this.bufferLength++]=e[n++],t--;64===this.bufferLength&&(ce(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(t>=64&&(n=ce(this.temp,this.state,e,n,t),t%=64);t>0;)this.buffer[this.bufferLength++]=e[n++],t--;return this}finish(e){if(!this.finished){const e=this.bytesHashed,t=this.bufferLength,n=e/536870912|0,i=e<<3,r=e%64<56?64:128;this.buffer[t]=128;for(let e=t+1;e<r-8;e++)this.buffer[e]=0;this.buffer[r-8]=n>>>24&255,this.buffer[r-7]=n>>>16&255,this.buffer[r-6]=n>>>8&255,this.buffer[r-5]=n>>>0&255,this.buffer[r-4]=i>>>24&255,this.buffer[r-3]=i>>>16&255,this.buffer[r-2]=i>>>8&255,this.buffer[r-1]=i>>>0&255,ce(this.temp,this.state,this.buffer,0,r),this.finished=!0}for(let t=0;t<8;t++)e[4*t+0]=this.state[t]>>>24&255,e[4*t+1]=this.state[t]>>>16&255,e[4*t+2]=this.state[t]>>>8&255,e[4*t+3]=this.state[t]>>>0&255;return this}digest(){const e=new Uint8Array(this.digestLength);return this.finish(e),e}_saveState(e){for(let t=0;t<this.state.length;t++)e[t]=this.state[t]}_restoreState(e,t){for(let t=0;t<this.state.length;t++)this.state[t]=e[t];this.bytesHashed=t,this.finished=!1,this.bufferLength=0}}function le(e){const t=(new ue).update(e),n=t.digest();return t.clean(),n}new Uint8Array(32);var de=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};function he(e,t){return de(this,void 0,void 0,(function*(){const n=e=>de(this,void 0,void 0,(function*(){if(e){return(yield Promise.all(Object.keys(e).map((n=>Promise.all(e[n].map((e=>t(e)))).then((e=>({peopleKey:n,sanitizedPeopleValues:e}))))))).reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.peopleKey]:t.sanitizedPeopleValues})),{})}}));return void 0===e?Promise.resolve(e):(e.title?t(e.title):Promise.resolve(void 0)).then((i=>de(this,void 0,void 0,(function*(){return e.items?{sanitizedTitle:i,sanitizedItems:yield Promise.all(e.items.map((e=>t(e.text).then((n=>e.title?t(e.title).then((e=>({sanitizedItemText:n,sanitizedItemTitle:e}))):{sanitizedItemText:n,sanitizedItemTitle:void 0})).then((({sanitizedItemText:t,sanitizedItemTitle:i})=>de(this,void 0,void 0,(function*(){return{text:t,title:i,people:yield n(e.people)}})))))))}:{sanitizedTitle:i,sanitizedItems:void 0}})))).then((({sanitizedTitle:t,sanitizedItems:i})=>de(this,void 0,void 0,(function*(){return{title:t,items:i,people:yield n(e.people)}}))))}))}function fe(e,t){return de(this,void 0,void 0,(function*(){return Promise.all(e.map((e=>t(e.value).then((t=>Object.assign(Object.assign({},e),{value:t}))))))}))}function ge(e,t){return de(this,void 0,void 0,(function*(){return void 0===e?Promise.resolve(e):t(e.text).then((t=>Object.assign(Object.assign({},e),{text:t})))}))}function pe(e,t){return de(this,void 0,void 0,(function*(){return void 0===e.context.intent?Promise.resolve(e):t(e.context.intent).then((t=>Object.assign(Object.assign({},e),{context:Object.assign(Object.assign({},e.context),{intent:t})})))}))}function me(e,t){return de(this,void 0,void 0,(function*(){return t(e.token).then((t=>Object.assign(Object.assign({},e),{token:t})))}))}function ve(e,t){return de(this,void 0,void 0,(function*(){const n=e.text;return(n?t(n.plain).then((e=>de(this,void 0,void 0,(function*(){return{unsanitizedTextPlain:e,unsanitizedTextDelta:yield ye(n.delta,t)}})))):Promise.resolve({unsanitizedTextPlain:void 0,unsanitizedTextDelta:new F.i})).then((({unsanitizedTextPlain:n,unsanitizedTextDelta:i})=>de(this,void 0,void 0,(function*(){const r=e.withVoiceText;return r?{unsanitizedTextPlain:n,unsanitizedTextDelta:i,unsanitizedWithVoiceTextPlain:yield t(r.plain),unsanitizedWithVoiceTextDelta:yield ye(r.delta,t)}:{unsanitizedTextPlain:n,unsanitizedTextDelta:i,unsanitizedWithVoiceTextPlain:void 0,unsanitizedWithVoiceTextDelta:new F.i}})))).then((({unsanitizedTextPlain:t,unsanitizedTextDelta:n,unsanitizedWithVoiceTextPlain:i,unsanitizedWithVoiceTextDelta:r})=>Object.assign(Object.assign({},e),{text:e.text?Object.assign(Object.assign({},e.text),{plain:null!=t?t:e.text.plain,delta:n}):void 0,withVoiceText:e.withVoiceText?Object.assign(Object.assign({},e.withVoiceText),{plain:null!=i?i:e.withVoiceText.plain,delta:r}):void 0})))}))}function ye(e,t){return de(this,void 0,void 0,(function*(){const n=yield(0,y.zG)(e,G,P.map((e=>Promise.all(e.ops.map((e=>H.s.isInsertString(e)?t(e.insert).then((t=>Object.assign(Object.assign({},e),{insert:t}))):e))))),P.getOrElse((()=>Promise.resolve([]))));return new F.i([...n])}))}},71761:(e,t,n)=>{n.r(t),n.d(t,{ActionArg:()=>m,ActionArgDef:()=>v,ActionArgDefString:()=>b,ActionArgDefStringHint:()=>y,ActionDef:()=>k,ActionDefGeneratesTextType:()=>S,ActionInfo:()=>w,AvailableVoiceProfile:()=>A,AvailableVoiceProfileSection:()=>I,AvailableVoiceProfileSectionTag:()=>x,AvailableVoiceProfileSectionTagState:()=>_,AvailableVoiceProfiles:()=>C,ClientMessage:()=>u,ClientMessageImplementations:()=>Ae,Context:()=>R,DocumentOverview:()=>T,Error:()=>O,ErrorKind:()=>P,GeneratedText:()=>E,GenerationMode:()=>U,Message:()=>B,MessageAction:()=>z,MessageChunk:()=>q,MessageError:()=>L,MessageGetContext:()=>M,MessageGetHistory:()=>D,MessageGetUserState:()=>G,MessageInterrupt:()=>N,MessageInvalidateContext:()=>j,MessageResult:()=>J,MessageResultChangesSummary:()=>Z,MessageSearchReferences:()=>V,MessageSearchReferencesResult:()=>K,MessageSetContext:()=>W,MessageSetHistory:()=>te,MessageSetHistoryCard:()=>ee,MessageSetHistoryCardTitle:()=>Q,MessageSetHistoryCardTitleAction:()=>X,MessageSetHistoryCardTitleUserPrompt:()=>Y,MessageSetUserState:()=>$,MessageSetVoice:()=>F,MessageSetVoiceProfile:()=>H,Metadata:()=>ne,OuterContext:()=>re,OuterContextItem:()=>ie,PreviousText:()=>se,PreviousTextHistory:()=>ae,PreviousTextRegular:()=>oe,PreviousTextWriterExpert:()=>ce,ProtocolMessage:()=>l,Reference:()=>ue,ReferencePrivacyLevel:()=>le,ReferencePrivacyLevelPublic:()=>de,ReferencePrivacyLevelRestricted:()=>he,Root:()=>p,ServerMessage:()=>d,ServerMessageImplementations:()=>Ce,SpecialView:()=>fe,SpecialViewAiUsageAlert:()=>ge,StartMessage:()=>h,StartedMessage:()=>f,Style:()=>pe,Text:()=>me,TextLike:()=>g,TextRange:()=>ve,Toggle:()=>ye,UrlReference:()=>be,Usage:()=>Se,UserState:()=>we,UserStateSettings:()=>ke,Voice:()=>_e,VoiceProfileSettings:()=>Ie,VoiceProfileSettingsMyVoiceIsEnabledByDefault:()=>xe,encoderSchemable:()=>Ue,extend:()=>Ee,interpreter:()=>Oe,make:()=>Pe});var i=n(59312),r=n(50687),s=n(83257),o=n(18164),a=n(73915),c=n(57050),u=Pe((function(e){return Te(l(e),e.struct({}))(e)})),l=Pe((function(e){return e.struct({id:e.number})})),d=Pe((function(e){return Te(l(e),e.struct({}))(e)})),h=Pe((function(e){return e.intersect(e.partial({docIdIsTransient:e.boolean}))(e.struct({}))})),f=Pe((function(e){return e.struct({cheetahState:we(e)})})),g=Pe((function(e){return e.struct({plain:e.sensitiveString,delta:e.sensitiveDelta})})),p=Pe((function(e){return B(e)})),m=Pe((function(e){return e.struct({name:e.string,value:e.sensitiveString})})),v=Pe((function(e){var t;return e.sum("valueType")(((t={}).string=b(e),t))})),y=Pe((function(e){return e.struct({header:e.string,text:e.readonly(e.array(e.string))})})),b=Pe((function(e){return e.intersect(e.partial({hint:y(e)}))(e.struct({valueType:e.literal("string"),label:e.string,name:e.string}))})),S=Re(r.cX),k=Pe((function(e){return e.intersect(e.partial({generatesTextType:S(e)}))(e.struct({id:e.string,iconUrl:e.string,group:e.string,label:e.string,searchTags:e.readonly(e.array(e.string)),args:e.readonly(e.array(v(e)))}))})),w=Pe((function(e){return e.intersect(e.partial({useReferences:e.readonly(e.array(be(e)))}))(e.intersect(e.partial({omitReferenceIds:e.readonly(e.array(e.string))}))(e.struct({contextId:e.string,triggerContextId:e.string,actionId:e.string,args:e.readonly(e.array(m(e)))})))})),_=Re(r.ES),x=Pe((function(e){return e.struct({name:e.string,state:_(e)})})),I=Pe((function(e){return e.struct({name:e.string,tags:e.readonly(e.array(x(e)))})})),A=Pe((function(e){return e.struct({name:e.string,summary:e.string,selected:e.boolean,sections:e.readonly(e.array(I(e)))})})),C=Pe((function(e){return e.readonly(e.array(A(e)))})),R=Pe((function(e){return e.intersect(e.partial({voiceProfileSettings:Ie(e)}))(e.intersect(e.partial({intent:e.sensitiveString}))(e.intersect(e.partial({documentOverview:T(e)}))(e.intersect(e.partial({specialView:fe(e)}))(e.intersect(e.partial({metadata:ne(e)}))(e.struct({id:e.string,voice:_e(e),availableActions:e.readonly(e.array(k(e))),parentAction:w(e),stateBlob:e.string,promptAction:k(e),quickRewriteAction:k(e)}))))))})),T=Pe((function(e){return e.struct({title:e.string,summary:e.string})})),P=Re(r.oS),O=Pe((function(e){return e.struct({kind:P(e),title:e.string,text:e.string})})),E=Pe((function(e){return Te(g(e),e.struct({plain:e.sensitiveString,interrupted:e.boolean,renderDiff:e.boolean,delta:e.sensitiveDelta}))(e)})),U=Re(r.s2),B=Pe((function(e){var t;return Te(l(e),e.sum("action")(((t={})["cheetah:getContext"]=M(e),t["cheetah:invalidateContext"]=j(e),t["cheetah:action"]=z(e),t["cheetah:setVoice"]=F(e),t["cheetah:setVoiceProfile"]=H(e),t["cheetah:interrupt"]=N(e),t["cheetah:getUserState"]=G(e),t["cheetah:searchReferences"]=V(e),t["cheetah:getHistory"]=D(e),t["cheetah:error"]=L(e),t["cheetah:setContext"]=W(e),t["cheetah:searchReferencesResult"]=K(e),t["cheetah:chunk"]=q(e),t["cheetah:result"]=J(e),t["cheetah:setUserState"]=$(e),t["cheetah:setHistory"]=te(e),t)))(e)})),M=Pe((function(e){return Te(u(e),e.intersect(e.partial({outerContext:re(e)}))(e.intersect(e.partial({selectedRange:ve(e)}))(e.intersect(e.partial({stateBlob:e.string}))(e.intersect(e.partial({previousText:se(e)}))(e.intersect(e.partial({metadata:ne(e)}))(e.struct({action:e.literal("cheetah:getContext"),rev:e.number,generationMode:U(e)})))))))(e)})),j=Pe((function(e){return Te(d(e),e.struct({action:e.literal("cheetah:invalidateContext")}))(e)})),z=Pe((function(e){return Te(u(e),e.intersect(e.partial({useReferences:e.readonly(e.array(be(e)))}))(e.intersect(e.partial({omitReferenceIds:e.readonly(e.array(e.string))}))(e.intersect(e.partial({previousText:se(e)}))(e.intersect(e.partial({metadata:ne(e)}))(e.struct({action:e.literal("cheetah:action"),rev:e.number,contextId:e.string,triggerContextId:e.string,actionId:e.string,stateBlob:e.string,args:e.readonly(e.array(m(e)))}))))))(e)})),F=Pe((function(e){return Te(u(e),e.struct({action:e.literal("cheetah:setVoice"),voice:_e(e)}))(e)})),H=Pe((function(e){return Te(u(e),e.intersect(e.partial({role:e.string}))(e.intersect(e.partial({isEnabledByDefault:e.boolean}))(e.intersect(e.partial({profiles:C(e)}))(e.struct({action:e.literal("cheetah:setVoiceProfile")})))))(e)})),N=Pe((function(e){return Te(u(e),e.struct({action:e.literal("cheetah:interrupt"),promptId:e.number}))(e)})),G=Pe((function(e){return Te(u(e),e.struct({action:e.literal("cheetah:getUserState")}))(e)})),V=Pe((function(e){return Te(u(e),e.intersect(e.partial({url:e.string}))(e.struct({action:e.literal("cheetah:searchReferences")})))(e)})),D=Pe((function(e){return Te(u(e),e.struct({action:e.literal("cheetah:getHistory")}))(e)})),L=Pe((function(e){return Te(d(e),e.struct({action:e.literal("cheetah:error"),promptId:e.number,error:O(e)}))(e)})),W=Pe((function(e){return Te(d(e),e.intersect(e.partial({progressMessage:e.string}))(e.struct({action:e.literal("cheetah:setContext"),promptId:e.number,context:R(e),usage:Se(e)})))(e)})),K=Pe((function(e){return Te(d(e),e.struct({action:e.literal("cheetah:searchReferencesResult"),promptId:e.number,references:e.readonly(e.array(ue(e)))}))(e)})),q=Pe((function(e){return Te(d(e),e.intersect(e.partial({metadata:ne(e)}))(e.struct({action:e.literal("cheetah:chunk"),promptId:e.number,token:e.sensitiveString})))(e)})),Z=Pe((function(e){return e.struct({title:e.string,description:e.readonly(e.array(e.string))})})),J=Pe((function(e){return Te(d(e),e.intersect(e.partial({metadata:ne(e)}))(e.intersect(e.partial({context:R(e)}))(e.intersect(e.partial({error:O(e)}))(e.intersect(e.partial({text:E(e)}))(e.intersect(e.partial({withVoiceText:E(e)}))(e.intersect(e.partial({showVoiceTextByDefault:e.boolean}))(e.intersect(e.partial({references:e.readonly(e.array(ue(e)))}))(e.intersect(e.partial({changesSummary:Z(e)}))(e.struct({action:e.literal("cheetah:result"),promptId:e.number,usage:Se(e)}))))))))))(e)})),$=Pe((function(e){return Te(d(e),e.struct({action:e.literal("cheetah:setUserState"),state:we(e)}))(e)})),Q=Pe((function(e){var t;return e.sum("kind")(((t={}).userPrompt=Y(e),t.action=X(e),t))})),Y=Pe((function(e){return e.struct({kind:e.literal("userPrompt"),text:e.string})})),X=Pe((function(e){return e.struct({kind:e.literal("action"),iconUrl:e.string,label:e.string})})),ee=Pe((function(e){return e.intersect(e.partial({showVoiceTextByDefault:e.boolean}))(e.struct({id:e.string,text:me(e),withVoiceText:me(e),title:Q(e),references:e.readonly(e.array(ue(e)))}))})),te=Pe((function(e){return Te(d(e),e.struct({action:e.literal("cheetah:setHistory"),cards:e.readonly(e.array(ee(e)))}))(e)})),ne=Pe((function(e){return e.any})),ie=Pe((function(e){return e.intersect(e.partial({title:e.sensitiveString}))(e.intersect(e.partial({people:e.readonly(e.record(e.readonly(e.array(e.sensitiveString))))}))(e.struct({text:e.sensitiveString})))})),re=Pe((function(e){return e.intersect(e.partial({pageIdHash:e.string}))(e.intersect(e.partial({title:e.sensitiveString}))(e.intersect(e.partial({people:e.readonly(e.record(e.readonly(e.array(e.sensitiveString))))}))(e.intersect(e.partial({items:e.readonly(e.array(ie(e)))}))(e.struct({})))))})),se=Pe((function(e){var t;return e.sum("kind")(((t={}).regular=oe(e),t.history=ae(e),t.writerExpert=ce(e),t))})),oe=Pe((function(e){return e.struct({kind:e.literal("regular"),text:e.string})})),ae=Pe((function(e){return e.struct({kind:e.literal("history"),text:e.string})})),ce=Pe((function(e){return e.struct({kind:e.literal("writerExpert"),text:e.string,suggestionId:e.string,pname:e.string})})),ue=Pe((function(e){return e.intersect(e.partial({url:e.string}))(e.struct({id:e.string,privacyLevel:le(e),title:e.string,iconUrl:e.string}))})),le=Pe((function(e){var t;return e.sum("kind")(((t={}).public=de(e),t.restricted=he(e),t))})),de=Pe((function(e){return e.struct({kind:e.literal("public")})})),he=Pe((function(e){return e.struct({kind:e.literal("restricted")})})),fe=Pe((function(e){var t;return e.sum("kind")(((t={}).aiUsageAlert=ge(e),t))})),ge=Pe((function(e){return e.struct({kind:e.literal("aiUsageAlert")})})),pe=Pe((function(e){return e.struct({button:ye(e),tones:e.readonly(e.array(ye(e))),maxTones:e.number})})),me=Pe((function(e){return Te(g(e),e.struct({}))(e)})),ve=Pe((function(e){return e.struct({start:e.number,end:e.number})})),ye=Pe((function(e){return e.struct({iconUrl:e.string,label:e.string,description:e.string})})),be=Pe((function(e){return e.struct({url:e.string,referenceId:e.string})})),Se=Pe((function(e){return e.struct({promptsRemaining:e.number,promptsAllocated:e.number,refillDate:e.string})})),ke=Pe((function(e){return e.struct({inlineQuickReplyEnabled:e.boolean,inlineRewriteEnabled:e.boolean})})),we=Pe((function(e){return e.intersect(e.partial({historyItems:e.number}))(e.struct({settings:ke(e),usage:Se(e)}))})),_e=Pe((function(e){return e.intersect(e.partial({styles:e.readonly(e.array(pe(e)))}))(e.intersect(e.partial({selectedRole:e.string}))(e.intersect(e.partial({roles:e.readonly(e.array(e.string))}))(e.struct({selectedStyle:e.string,selectedTones:e.readonly(e.array(e.string)),needSetup:e.boolean}))))})),xe=Pe((function(e){return e.struct({state:e.boolean,label:e.string})})),Ie=Pe((function(e){return e.struct({userName:e.string,myVoiceIsEnabledByDefault:xe(e),title:e.string,subTitle:e.string,profiles:C(e)})})),Ae=Pe((function(e){var t;return e.sum("action")(((t={})["cheetah:getContext"]=M(e),t["cheetah:action"]=z(e),t["cheetah:setVoice"]=F(e),t["cheetah:setVoiceProfile"]=H(e),t["cheetah:interrupt"]=N(e),t["cheetah:getUserState"]=G(e),t["cheetah:searchReferences"]=V(e),t["cheetah:getHistory"]=D(e),t))})),Ce=Pe((function(e){var t;return e.sum("action")(((t={})["cheetah:invalidateContext"]=j(e),t["cheetah:error"]=L(e),t["cheetah:setContext"]=W(e),t["cheetah:searchReferencesResult"]=K(e),t["cheetah:chunk"]=q(e),t["cheetah:result"]=J(e),t["cheetah:setUserState"]=$(e),t["cheetah:setHistory"]=te(e),t))}));function Re(e){var t=Object.keys(e).map((function(t){return e[t]})),n=t[0],r=t.slice(1);return Pe((function(e){return e.literal.apply(e,(0,i.__spreadArray)([n],r,!1))}))}function Te(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Pe((function(t){return e.reduce((function(e,n){return t.intersect(n)(e)}))}))}function Pe(e){return o.H(e)}var Oe=(0,c.MZ)(a.n);function Ee(e){return function(t){return(0,i.__assign)((0,i.__assign)({},e),t)}}var Ue={URI:s.ov,literal:function(){return s.id()},string:s.id(),number:s.id(),boolean:s.id(),nullable:s.AG,type:s.dt,struct:s.n_,partial:s.r$,record:s.IM,array:s.IX,tuple:s.bc,intersect:s.wf,sum:s.Sm,lazy:function(e,t){return s.Vo(t)},readonly:s.OT}},50687:(e,t,n)=>{var i,r,s,o;n.d(t,{ES:()=>r,cX:()=>i,oS:()=>s,s2:()=>o}),function(e){e.Insertable="insertable",e.NonInsertable="non_insertable"}(i||(i={})),function(e){e.Active="active",e.Snoozed="snoozed"}(r||(r={})),function(e){e.Generic="generic",e.Overflow="overflow",e.PromptsLimitExceeded="promptsLimitExceeded",e.SensitiveContent="sensitiveContent",e.ServerOverloaded="serverOverloaded",e.UnsupportedLanguage="unsupportedLanguage"}(s||(s={})),function(e){e.Ideation="ideation",e.PushRewrite="pushRewrite",e.QuickReply="quickReply",e.QuickRewrite="quickRewrite",e.Rewrite="rewrite"}(o||(o={}))},24782:(e,t)=>{t.byteLength=function(e){var t=c(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){var t,n,s=c(e),o=s[0],a=s[1],u=new r(function(e,t,n){return 3*(t+n)/4-n}(0,o,a)),l=0,d=a>0?o-4:o;for(n=0;n<d;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;2===a&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,u[l++]=255&t);1===a&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t);return u},t.fromByteArray=function(e){for(var t,i=e.length,r=i%3,s=[],o=16383,a=0,c=i-r;a<c;a+=o)s.push(u(e,a,a+o>c?c:a+o));1===r?(t=e[i-1],s.push(n[t>>2]+n[t<<4&63]+"==")):2===r&&(t=(e[i-2]<<8)+e[i-1],s.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return s.join("")};for(var n=[],i=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=s.length;o<a;++o)n[o]=s[o],i[s.charCodeAt(o)]=o;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,i){for(var r,s,o=[],a=t;a<i;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(n[(s=r)>>18&63]+n[s>>12&63]+n[s>>6&63]+n[63&s]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},30816:(e,t,n)=>{var i=n(24782),r=n(78898),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=c,t.INSPECT_MAX_BYTES=50;var o=2147483647;function a(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return u(e,t,n)}function u(e,t,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|p(e,t),i=a(n),r=i.write(e,t);r!==n&&(i=i.slice(0,r));return i}(e,t);if(ArrayBuffer.isView(e))return function(e){if(G(e,Uint8Array)){var t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return h(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(G(e,ArrayBuffer)||e&&G(e.buffer,ArrayBuffer))return f(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(G(e,SharedArrayBuffer)||e&&G(e.buffer,SharedArrayBuffer)))return f(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return c.from(i,t,n);var r=function(e){if(c.isBuffer(e)){var t=0|g(e.length),n=a(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||V(e.length)?a(0):h(e);if("Buffer"===e.type&&Array.isArray(e.data))return h(e.data)}(e);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return l(e),a(e<0?0:0|g(e))}function h(e){for(var t=e.length<0?0:0|g(e.length),n=a(t),i=0;i<t;i+=1)n[i]=255&e[i];return n}function f(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var i;return i=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(i,c.prototype),i}function g(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function p(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||G(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return F(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(e).length;default:if(r)return i?-1:F(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,n);case"utf8":case"utf-8":return A(this,t,n);case"ascii":return R(this,t,n);case"latin1":case"binary":return T(this,t,n);case"base64":return I(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function v(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function y(e,t,n,i,r){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),V(n=+n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=c.from(t,i)),c.isBuffer(t))return 0===t.length?-1:b(e,t,n,i,r);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,i,r){var s,o=1,a=e.length,c=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;o=2,a/=2,c/=2,n/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(r){var l=-1;for(s=n;s<a;s++)if(u(e,s)===u(t,-1===l?0:s-l)){if(-1===l&&(l=s),s-l+1===c)return l*o}else-1!==l&&(s-=s-l),l=-1}else for(n+c>a&&(n=a-c),s=n;s>=0;s--){for(var d=!0,h=0;h<c;h++)if(u(e,s+h)!==u(t,h)){d=!1;break}if(d)return s}return-1}function S(e,t,n,i){n=Number(n)||0;var r=e.length-n;i?(i=Number(i))>r&&(i=r):i=r;var s=t.length;i>s/2&&(i=s/2);for(var o=0;o<i;++o){var a=parseInt(t.substr(2*o,2),16);if(V(a))return o;e[n+o]=a}return o}function k(e,t,n,i){return N(F(t,e.length-n),e,n,i)}function w(e,t,n,i){return N(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function _(e,t,n,i){return N(H(t),e,n,i)}function x(e,t,n,i){return N(function(e,t){for(var n,i,r,s=[],o=0;o<e.length&&!((t-=2)<0);++o)i=(n=e.charCodeAt(o))>>8,r=n%256,s.push(r),s.push(i);return s}(t,e.length-n),e,n,i)}function I(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function A(e,t,n){n=Math.min(e.length,n);for(var i=[],r=t;r<n;){var s,o,a,c,u=e[r],l=null,d=u>239?4:u>223?3:u>191?2:1;if(r+d<=n)switch(d){case 1:u<128&&(l=u);break;case 2:128==(192&(s=e[r+1]))&&(c=(31&u)<<6|63&s)>127&&(l=c);break;case 3:s=e[r+1],o=e[r+2],128==(192&s)&&128==(192&o)&&(c=(15&u)<<12|(63&s)<<6|63&o)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:s=e[r+1],o=e[r+2],a=e[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(c=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,d=1):l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|1023&l),i.push(l),r+=d}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);var n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=C));return n}(i)}c.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,n){return u(e,t,n)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,n){return function(e,t,n){return l(e),e<=0?a(e):void 0!==t?"string"==typeof n?a(e).fill(t,n):a(e).fill(t):a(e)}(e,t,n)},c.allocUnsafe=function(e){return d(e)},c.allocUnsafeSlow=function(e){return d(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(G(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),G(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,i=t.length,r=0,s=Math.min(n,i);r<s;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=c.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var s=e[n];if(G(s,Uint8Array))r+s.length>i.length?c.from(s).copy(i,r):Uint8Array.prototype.set.call(i,s,r);else{if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,r)}r+=s.length}return i},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},c.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?A(this,0,e):m.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},s&&(c.prototype[s]=c.prototype.inspect),c.prototype.compare=function(e,t,n,i,r){if(G(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=n)return 0;if(i>=r)return-1;if(t>=n)return 1;if(this===e)return 0;for(var s=(r>>>=0)-(i>>>=0),o=(n>>>=0)-(t>>>=0),a=Math.min(s,o),u=this.slice(i,r),l=e.slice(t,n),d=0;d<a;++d)if(u[d]!==l[d]){s=u[d],o=l[d];break}return s<o?-1:o<s?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},c.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return S(this,e,t,n);case"utf8":case"utf-8":return k(this,e,t,n);case"ascii":case"latin1":case"binary":return w(this,e,t,n);case"base64":return _(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function R(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function T(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function P(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var r="",s=t;s<n;++s)r+=D[e[s]];return r}function O(e,t,n){for(var i=e.slice(t,n),r="",s=0;s<i.length-1;s+=2)r+=String.fromCharCode(i[s]+256*i[s+1]);return r}function E(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function U(e,t,n,i,r,s){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<s)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function B(e,t,n,i,r,s){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function M(e,t,n,i,s){return t=+t,n>>>=0,s||B(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function j(e,t,n,i,s){return t=+t,n>>>=0,s||B(e,0,n,8),r.write(e,t,n,i,52,8),n+8}c.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var i=this.subarray(e,t);return Object.setPrototypeOf(i,c.prototype),i},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||E(e,t,this.length);for(var i=this[e],r=1,s=0;++s<t&&(r*=256);)i+=this[e+s]*r;return i},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||E(e,t,this.length);for(var i=this[e+--t],r=1;t>0&&(r*=256);)i+=this[e+--t]*r;return i},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||E(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||E(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||E(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||E(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||E(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||E(e,t,this.length);for(var i=this[e],r=1,s=0;++s<t&&(r*=256);)i+=this[e+s]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||E(e,t,this.length);for(var i=t,r=1,s=this[e+--i];i>0&&(r*=256);)s+=this[e+--i]*r;return s>=(r*=128)&&(s-=Math.pow(2,8*t)),s},c.prototype.readInt8=function(e,t){return e>>>=0,t||E(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||E(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){e>>>=0,t||E(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||E(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||E(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return e>>>=0,t||E(e,4,this.length),r.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||E(e,4,this.length),r.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||E(e,8,this.length),r.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||E(e,8,this.length),r.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,n,i){(e=+e,t>>>=0,n>>>=0,i)||U(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,s=0;for(this[t]=255&e;++s<n&&(r*=256);)this[t+s]=e/r&255;return t+n},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,n,i){(e=+e,t>>>=0,n>>>=0,i)||U(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,s=1;for(this[t+r]=255&e;--r>=0&&(s*=256);)this[t+r]=e/s&255;return t+n},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t>>>=0,!i){var r=Math.pow(2,8*n-1);U(this,e,t,n,r-1,-r)}var s=0,o=1,a=0;for(this[t]=255&e;++s<n&&(o*=256);)e<0&&0===a&&0!==this[t+s-1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+n},c.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t>>>=0,!i){var r=Math.pow(2,8*n-1);U(this,e,t,n,r-1,-r)}var s=n-1,o=1,a=0;for(this[t+s]=255&e;--s>=0&&(o*=256);)e<0&&0===a&&0!==this[t+s+1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeFloatLE=function(e,t,n){return M(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return M(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return j(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return j(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,i){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var r=i-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),t),r},c.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!c.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===e.length){var r=e.charCodeAt(0);("utf8"===i&&r<128||"latin1"===i)&&(e=r)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var s;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(s=t;s<n;++s)this[s]=e;else{var o=c.isBuffer(e)?e:c.from(e,i),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<n-t;++s)this[s+t]=o[s%a]}return this};var z=/[^+/0-9A-Za-z-_]/g;function F(e,t){var n;t=t||1/0;for(var i=e.length,r=null,s=[],o=0;o<i;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===i){(t-=3)>-1&&s.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&s.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function H(e){return i.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(z,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function N(e,t,n,i){for(var r=0;r<i&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}function G(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function V(e){return e!=e}var D=function(){for(var e="0123456789abcdef",t=new Array(256),n=0;n<16;++n)for(var i=16*n,r=0;r<16;++r)t[i+r]=e[n]+e[r];return t}()},13853:(e,t,n)=>{n.d(t,{$T:()=>I,AO:()=>a,DZ:()=>P,Eh:()=>c,G:()=>u,G0:()=>m,KX:()=>f,Lf:()=>S,Lx:()=>_,Od:()=>A,UI:()=>l,ZN:()=>s,e5:()=>b,hX:()=>g,jV:()=>v,nI:()=>C,oA:()=>R,oP:()=>k,ri:()=>x,t9:()=>p,tS:()=>h,tV:()=>y,u4:()=>w,xu:()=>T,yW:()=>d});var i=n(73975),r=n(57050);function s(e){return{show:function(t){var n="";return t.forEach((function(t){n+=e.show(t)+", "})),""!==n&&(n=n.substring(0,n.length-2)),"new Set(["+n+"])"}}}var o=new Set;function a(e){return function(t){var n=[];return t.forEach((function(e){return n.push(e)})),n.sort(e.compare)}}function c(e){var t=f(e);return(0,i.f7)((function(e,n){return t(e,n)&&t(n,e)}))}function u(e){return function(t){for(var n,i=t.values(),r=!1;!r&&!(n=i.next()).done;)r=e(n.value);return r}}function l(e){var t=p(e);return function(e){return function(n){var i=new Set;return n.forEach((function(n){var r=e(n);t(r,i)||i.add(r)})),i}}}function d(e){return(0,r.ff)(u((0,r.ff)(e)))}function h(e){var t=p(e);return function(e){return function(n){var i=new Set;return n.forEach((function(n){e(n).forEach((function(e){t(e,i)||i.add(e)}))})),i}}}function f(e){var t=p(e);return function(n,i){if(void 0===i){var r=f(e);return function(e){return r(e,n)}}return d((function(e){return t(e,i)}))(n)}}function g(e){return function(t){for(var n,i=t.values(),r=new Set;!(n=i.next()).done;){var s=n.value;e(s)&&r.add(s)}return r}}function p(e){return function(t,n){if(void 0===n){var i=p(e);return function(e){return i(t,e)}}for(var r,s=n.values(),o=!1;!o&&!(r=s.next()).done;)o=e.equals(t,r.value);return o}}function m(e){var t=p(e);return function(n,i){if(void 0===i){var r=m(e);return function(e){return r(n,e)}}if(n===o)return i;if(i===o)return n;var s=new Set(n);return i.forEach((function(e){t(e,s)||s.add(e)})),s}}function v(e){var t=p(e);return function(n,i){if(void 0===i){var r=v(e);return function(e){return r(e,n)}}if(n===o||i===o)return o;var s=new Set;return n.forEach((function(e){t(e,i)&&s.add(e)})),s}}function y(e,t){return function(n){return function(i){for(var r,s=i.values(),o=new Set,a=new Set,c=p(e),u=p(t);!(r=s.next()).done;){var l=n(r.value);switch(l._tag){case"Left":c(l.left,o)||o.add(l.left);break;case"Right":u(l.right,a)||a.add(l.right)}}return{left:o,right:a}}}}function b(e){var t=p(e);return function(n,i){if(void 0===i){var r=b(e);return function(e){return r(e,n)}}return g((function(e){return!t(e,i)}))(n)}}function S(e){return{concat:m(e),empty:o}}function k(e){return{concat:v(e)}}function w(e){var t=a(e);return function(e,n){return function(i){return t(i).reduce(n,e)}}}function _(e,t){var n=a(e);return function(e){return function(i){return n(i).reduce((function(n,i){return t.concat(n,e(i))}),t.empty)}}}function x(e){return new Set([e])}function I(e){var t=p(e);return function(e){return function(n){if(t(e)(n))return n;var i=new Set(n);return i.add(e),i}}}function A(e){return function(t){return function(n){return g((function(n){return!e.equals(t,n)}))(n)}}}function C(e){return function(t){for(var n=t.length,i=new Set,r=p(e),s=0;s<n;s++){var o=t[s];r(o,i)||i.add(o)}return i}}function R(e){return P(e)(r.yR)}function T(e,t){return function(n){var i=p(e),r=p(t),s=new Set,o=new Set;return n.forEach((function(e){switch(e._tag){case"Left":i(e.left,s)||s.add(e.left);break;case"Right":r(e.right,o)||o.add(e.right)}})),{left:s,right:o}}}function P(e){var t=p(e);return function(e){return function(n){var i=new Set;return n.forEach((function(n){var r=e(n);"Some"!==r._tag||t(r.value,i)||i.add(r.value)})),i}}}},78898:(e,t)=>{t.read=function(e,t,n,i,r){var s,o,a=8*r-i-1,c=(1<<a)-1,u=c>>1,l=-7,d=n?r-1:0,h=n?-1:1,f=e[t+d];for(d+=h,s=f&(1<<-l)-1,f>>=-l,l+=a;l>0;s=256*s+e[t+d],d+=h,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=i;l>0;o=256*o+e[t+d],d+=h,l-=8);if(0===s)s=1-u;else{if(s===c)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,i),s-=u}return(f?-1:1)*o*Math.pow(2,s-i)},t.write=function(e,t,n,i,r,s){var o,a,c,u=8*s-r-1,l=(1<<u)-1,d=l>>1,h=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:s-1,g=i?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+d>=1?h/c:h*Math.pow(2,1-d))*c>=2&&(o++,c/=2),o+d>=l?(a=0,o=l):o+d>=1?(a=(t*c-1)*Math.pow(2,r),o+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,r),o=0));r>=8;e[n+f]=255&a,f+=g,a/=256,r-=8);for(o=o<<r|a,u+=r;u>0;e[n+f]=255&o,f+=g,o/=256,u-=8);e[n+f-g]|=128*p}},83257:(e,t,n)=>{n.d(t,{AG:()=>s,IM:()=>u,IX:()=>l,OT:()=>p,Sm:()=>f,Vo:()=>g,bc:()=>d,dt:()=>a,id:()=>v,n_:()=>o,ov:()=>y,qm:()=>b,r$:()=>c,wf:()=>h});var i=n(18164),r=n(57050);function s(e){return{encode:function(t){return null===t?null:e.encode(t)}}}function o(e){return{encode:function(t){var n={};for(var i in e)n[i]=e[i].encode(t[i]);return n}}}var a=o;function c(e){return{encode:function(t){var n={};for(var i in e){var r=t[i];i in t&&(n[i]=void 0===r?void 0:e[i].encode(r))}return n}}}function u(e){return{encode:function(t){var n={};for(var i in t)n[i]=e.encode(t[i]);return n}}}function l(e){return{encode:function(t){return t.map(e.encode)}}}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{encode:function(t){return e.map((function(e,n){return e.encode(t[n])}))}}}var h=function(e){return function(t){return{encode:function(n){return(0,i.U)(t.encode(n),e.encode(n))}}}};function f(e){return function(t){return{encode:function(n){return t[n[e]].encode(n)}}}}function g(e){var t=(0,i.H)(e);return{encode:function(e){return t().encode(e)}}}var p=r.yR,m=function(e,t){return{encode:function(n){return e.encode(t(n))}}};function v(){return{encode:r.yR}}var y="io-ts/Encoder",b={URI:y,contramap:m}}}]);